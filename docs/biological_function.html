<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Inferring biological functions (optional) | Introduction to ASURAT (version 0.0.0.9001)</title>
  <meta name="description" content="This is a developmental version of ASURAT." />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Inferring biological functions (optional) | Introduction to ASURAT (version 0.0.0.9001)" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a developmental version of ASURAT." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Inferring biological functions (optional) | Introduction to ASURAT (version 0.0.0.9001)" />
  
  <meta name="twitter:description" content="This is a developmental version of ASURAT." />
  

<meta name="author" content="Keita Iida" />


<meta name="date" content="2021-09-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cell_type.html"/>
<link rel="next" href="pathway.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#license-and-description"><i class="fa fa-check"></i><b>1.1</b> License and description</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#computational-environment"><i class="fa fa-check"></i><b>1.2</b> Computational environment</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.3</b> Installation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dataset.html"><a href="dataset.html"><i class="fa fa-check"></i><b>2</b> Preparing data sets</a>
<ul>
<li class="chapter" data-level="2.1" data-path="dataset.html"><a href="dataset.html#case-i-10x-data-stewart-et-al.-nat-cancer-2020"><i class="fa fa-check"></i><b>2.1</b> Case I: 10x data (Stewart et al., Nat Cancer, 2020)</a></li>
<li class="chapter" data-level="2.2" data-path="dataset.html"><a href="dataset.html#case-ii-pdac-a-st-and-indrop-moncada-et-al.-nat-biotechnol-2020"><i class="fa fa-check"></i><b>2.2</b> Case II: PDAC-A ST and inDrop (Moncada et al., Nat Biotechnol, 2020)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="dataset.html"><a href="dataset.html#pdac-a-st"><i class="fa fa-check"></i><b>2.2.1</b> PDAC-A ST</a></li>
<li class="chapter" data-level="2.2.2" data-path="dataset.html"><a href="dataset.html#pdac-a-indrop"><i class="fa fa-check"></i><b>2.2.2</b> PDAC-A inDrop</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="dataset.html"><a href="dataset.html#case-iii-input-10x-pbmc-data"><i class="fa fa-check"></i><b>2.3</b> Case III: input 10x PBMC data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataqc.html"><a href="dataqc.html"><i class="fa fa-check"></i><b>3</b> Data quality control (QC)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dataqc.html"><a href="dataqc.html#quick-qc"><i class="fa fa-check"></i><b>3.1</b> Quick QC</a></li>
<li class="chapter" data-level="3.2" data-path="dataqc.html"><a href="dataqc.html#sample-qc"><i class="fa fa-check"></i><b>3.2</b> Sample QC</a></li>
<li class="chapter" data-level="3.3" data-path="dataqc.html"><a href="dataqc.html#variable-qc"><i class="fa fa-check"></i><b>3.3</b> Variable QC</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="normalization.html"><a href="normalization.html"><i class="fa fa-check"></i><b>4</b> Normalizing and centering data</a></li>
<li class="chapter" data-level="5" data-path="integration.html"><a href="integration.html"><i class="fa fa-check"></i><b>5</b> Data integration</a>
<ul>
<li class="chapter" data-level="5.1" data-path="integration.html"><a href="integration.html#integrate-pdac-indrop-and-st-data-by-seurat"><i class="fa fa-check"></i><b>5.1</b> Integrate PDAC inDrop and ST data by Seurat</a></li>
<li class="chapter" data-level="5.2" data-path="integration.html"><a href="integration.html#identifying-differentially-expressed-genes"><i class="fa fa-check"></i><b>5.2</b> Identifying differentially expressed genes</a></li>
<li class="chapter" data-level="5.3" data-path="integration.html"><a href="integration.html#inferring-cell-cycle-phases"><i class="fa fa-check"></i><b>5.3</b> Inferring cell cycle phases</a></li>
<li class="chapter" data-level="5.4" data-path="integration.html"><a href="integration.html#save-results"><i class="fa fa-check"></i><b>5.4</b> Save results</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="computcorr.html"><a href="computcorr.html"><i class="fa fa-check"></i><b>6</b> Computing correlations among genes</a></li>
<li class="chapter" data-level="7" data-path="markergenes.html"><a href="markergenes.html"><i class="fa fa-check"></i><b>7</b> Checking expression profiles of marker genes</a></li>
<li class="chapter" data-level="8" data-path="collectdb.html"><a href="collectdb.html"><i class="fa fa-check"></i><b>8</b> Collecting databases (optional)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="collectdb.html"><a href="collectdb.html#disease-ontology-db"><i class="fa fa-check"></i><b>8.1</b> Disease Ontology DB</a></li>
<li class="chapter" data-level="8.2" data-path="collectdb.html"><a href="collectdb.html#cell-ontology-db"><i class="fa fa-check"></i><b>8.2</b> Cell Ontology DB</a></li>
<li class="chapter" data-level="8.3" data-path="collectdb.html"><a href="collectdb.html#gene-ontology-db"><i class="fa fa-check"></i><b>8.3</b> Gene Ontology DB</a></li>
<li class="chapter" data-level="8.4" data-path="collectdb.html"><a href="collectdb.html#kegg"><i class="fa fa-check"></i><b>8.4</b> KEGG</a></li>
<li class="chapter" data-level="8.5" data-path="collectdb.html"><a href="collectdb.html#custom-built-db-for-our-analysis-of-pdac-data"><i class="fa fa-check"></i><b>8.5</b> Custom-built DB for our analysis of PDAC data</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="cell_type.html"><a href="cell_type.html"><i class="fa fa-check"></i><b>9</b> Inferring cell types or diseases (optional)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cell_type.html"><a href="cell_type.html#add-database-to-asurat-objects"><i class="fa fa-check"></i><b>9.1</b> Add database to ASURAT objects</a></li>
<li class="chapter" data-level="9.2" data-path="cell_type.html"><a href="cell_type.html#quick-qc-1"><i class="fa fa-check"></i><b>9.2</b> Quick QC</a></li>
<li class="chapter" data-level="9.3" data-path="cell_type.html"><a href="cell_type.html#correlation-graph-based-decomposition"><i class="fa fa-check"></i><b>9.3</b> Correlation graph-based decomposition</a></li>
<li class="chapter" data-level="9.4" data-path="cell_type.html"><a href="cell_type.html#creating-systems-of-signs"><i class="fa fa-check"></i><b>9.4</b> Creating systems of signs</a></li>
<li class="chapter" data-level="9.5" data-path="cell_type.html"><a href="cell_type.html#removing-redundant-signs"><i class="fa fa-check"></i><b>9.5</b> Removing redundant signs</a></li>
<li class="chapter" data-level="9.6" data-path="cell_type.html"><a href="cell_type.html#creating-sign-by-sample-matrices"><i class="fa fa-check"></i><b>9.6</b> Creating sign-by-sample matrices</a></li>
<li class="chapter" data-level="9.7" data-path="cell_type.html"><a href="cell_type.html#dimensionality-reduction"><i class="fa fa-check"></i><b>9.7</b> Dimensionality reduction</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="cell_type.html"><a href="cell_type.html#principal-component-analysis-optional"><i class="fa fa-check"></i><b>9.7.1</b> Principal component analysis (optional)</a></li>
<li class="chapter" data-level="9.7.2" data-path="cell_type.html"><a href="cell_type.html#t-distributed-stochastic-neighbor-embedding-optional"><i class="fa fa-check"></i><b>9.7.2</b> t-distributed stochastic neighbor embedding (optional)</a></li>
<li class="chapter" data-level="9.7.3" data-path="cell_type.html"><a href="cell_type.html#uniform-manifold-approximation-and-projection-optional"><i class="fa fa-check"></i><b>9.7.3</b> Uniform manifold approximation and projection (optional)</a></li>
<li class="chapter" data-level="9.7.4" data-path="cell_type.html"><a href="cell_type.html#diffusion-map-optional"><i class="fa fa-check"></i><b>9.7.4</b> Diffusion map (optional)</a></li>
<li class="chapter" data-level="9.7.5" data-path="cell_type.html"><a href="cell_type.html#visualization"><i class="fa fa-check"></i><b>9.7.5</b> Visualization</a></li>
<li class="chapter" data-level="9.7.6" data-path="cell_type.html"><a href="cell_type.html#save-results."><i class="fa fa-check"></i><b>9.7.6</b> Save results.</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="cell_type.html"><a href="cell_type.html#cell-clustering"><i class="fa fa-check"></i><b>9.8</b> Cell clustering</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="cell_type.html"><a href="cell_type.html#partitioning-around-medoids-pam-optional"><i class="fa fa-check"></i><b>9.8.1</b> Partitioning around medoids (PAM) (optional)</a></li>
<li class="chapter" data-level="9.8.2" data-path="cell_type.html"><a href="cell_type.html#hierarchical-clustering-and-cutting-tree-optional"><i class="fa fa-check"></i><b>9.8.2</b> Hierarchical clustering and cutting tree (optional)</a></li>
<li class="chapter" data-level="9.8.3" data-path="cell_type.html"><a href="cell_type.html#community-detection-algorithm-with-k-nearest-neighbor-knn-graph-optional"><i class="fa fa-check"></i><b>9.8.3</b> Community detection algorithm with k-nearest neighbor (KNN) graph (optional)</a></li>
<li class="chapter" data-level="9.8.4" data-path="cell_type.html"><a href="cell_type.html#clustering-by-branch-detection-along-pseudotime-optional"><i class="fa fa-check"></i><b>9.8.4</b> Clustering by branch detection along pseudotime (optional)</a></li>
<li class="chapter" data-level="9.8.5" data-path="cell_type.html"><a href="cell_type.html#save-data"><i class="fa fa-check"></i><b>9.8.5</b> Save data</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="cell_type.html"><a href="cell_type.html#visualize-clustering-results"><i class="fa fa-check"></i><b>9.9</b> Visualize clustering results</a></li>
<li class="chapter" data-level="9.10" data-path="cell_type.html"><a href="cell_type.html#find-significant-signs"><i class="fa fa-check"></i><b>9.10</b> Find significant signs</a>
<ul>
<li class="chapter" data-level="9.10.1" data-path="cell_type.html"><a href="cell_type.html#compute-separation-indices"><i class="fa fa-check"></i><b>9.10.1</b> Compute separation indices</a></li>
<li class="chapter" data-level="9.10.2" data-path="cell_type.html"><a href="cell_type.html#investigate-sign-scores"><i class="fa fa-check"></i><b>9.10.2</b> Investigate sign scores</a></li>
</ul></li>
<li class="chapter" data-level="9.11" data-path="cell_type.html"><a href="cell_type.html#investigate-batch-effects"><i class="fa fa-check"></i><b>9.11</b> Investigate batch effects</a></li>
<li class="chapter" data-level="9.12" data-path="cell_type.html"><a href="cell_type.html#spatial-mapping-by-spaniel"><i class="fa fa-check"></i><b>9.12</b> Spatial mapping by Spaniel</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="biological_function.html"><a href="biological_function.html"><i class="fa fa-check"></i><b>10</b> Inferring biological functions (optional)</a>
<ul>
<li class="chapter" data-level="10.1" data-path="biological_function.html"><a href="biological_function.html#add-database-to-asurat-objects-1"><i class="fa fa-check"></i><b>10.1</b> Add database to ASURAT objects</a></li>
<li class="chapter" data-level="10.2" data-path="biological_function.html"><a href="biological_function.html#quick-qc-2"><i class="fa fa-check"></i><b>10.2</b> Quick QC</a></li>
<li class="chapter" data-level="10.3" data-path="biological_function.html"><a href="biological_function.html#correlation-graph-based-decomposition-1"><i class="fa fa-check"></i><b>10.3</b> Correlation graph-based decomposition</a></li>
<li class="chapter" data-level="10.4" data-path="biological_function.html"><a href="biological_function.html#creating-systems-of-signs-1"><i class="fa fa-check"></i><b>10.4</b> Creating systems of signs</a></li>
<li class="chapter" data-level="10.5" data-path="biological_function.html"><a href="biological_function.html#removing-redundant-signs-1"><i class="fa fa-check"></i><b>10.5</b> Removing redundant signs</a></li>
<li class="chapter" data-level="10.6" data-path="biological_function.html"><a href="biological_function.html#creating-sign-by-sample-matrices-1"><i class="fa fa-check"></i><b>10.6</b> Creating sign-by-sample matrices</a></li>
<li class="chapter" data-level="10.7" data-path="biological_function.html"><a href="biological_function.html#dimensionality-reduction-1"><i class="fa fa-check"></i><b>10.7</b> Dimensionality reduction</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="biological_function.html"><a href="biological_function.html#principal-component-analysis-optional-1"><i class="fa fa-check"></i><b>10.7.1</b> Principal component analysis (optional)</a></li>
<li class="chapter" data-level="10.7.2" data-path="biological_function.html"><a href="biological_function.html#t-distributed-stochastic-neighbor-embedding-optional-1"><i class="fa fa-check"></i><b>10.7.2</b> t-distributed stochastic neighbor embedding (optional)</a></li>
<li class="chapter" data-level="10.7.3" data-path="biological_function.html"><a href="biological_function.html#uniform-manifold-approximation-and-projection-optional-1"><i class="fa fa-check"></i><b>10.7.3</b> Uniform manifold approximation and projection (optional)</a></li>
<li class="chapter" data-level="10.7.4" data-path="biological_function.html"><a href="biological_function.html#diffusion-map-optional-1"><i class="fa fa-check"></i><b>10.7.4</b> Diffusion map (optional)</a></li>
<li class="chapter" data-level="10.7.5" data-path="biological_function.html"><a href="biological_function.html#visualization-1"><i class="fa fa-check"></i><b>10.7.5</b> Visualization</a></li>
<li class="chapter" data-level="10.7.6" data-path="biological_function.html"><a href="biological_function.html#save-results.-1"><i class="fa fa-check"></i><b>10.7.6</b> Save results.</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="biological_function.html"><a href="biological_function.html#cell-clustering-1"><i class="fa fa-check"></i><b>10.8</b> Cell clustering</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="biological_function.html"><a href="biological_function.html#partitioning-around-medoids-pam-optional-1"><i class="fa fa-check"></i><b>10.8.1</b> Partitioning around medoids (PAM) (optional)</a></li>
<li class="chapter" data-level="10.8.2" data-path="biological_function.html"><a href="biological_function.html#hierarchical-clustering-and-cutting-tree-optional-1"><i class="fa fa-check"></i><b>10.8.2</b> Hierarchical clustering and cutting tree (optional)</a></li>
<li class="chapter" data-level="10.8.3" data-path="biological_function.html"><a href="biological_function.html#community-detection-algorithm-with-k-nearest-neighbor-knn-graph-optional-1"><i class="fa fa-check"></i><b>10.8.3</b> Community detection algorithm with k-nearest neighbor (KNN) graph (optional)</a></li>
<li class="chapter" data-level="10.8.4" data-path="biological_function.html"><a href="biological_function.html#clustering-by-branch-detection-along-pseudotime-optional-1"><i class="fa fa-check"></i><b>10.8.4</b> Clustering by branch detection along pseudotime (optional)</a></li>
<li class="chapter" data-level="10.8.5" data-path="biological_function.html"><a href="biological_function.html#save-data-1"><i class="fa fa-check"></i><b>10.8.5</b> Save data</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="biological_function.html"><a href="biological_function.html#visualize-clustering-results-1"><i class="fa fa-check"></i><b>10.9</b> Visualize clustering results</a></li>
<li class="chapter" data-level="10.10" data-path="biological_function.html"><a href="biological_function.html#find-significant-signs-1"><i class="fa fa-check"></i><b>10.10</b> Find significant signs</a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="biological_function.html"><a href="biological_function.html#compute-separation-indices-1"><i class="fa fa-check"></i><b>10.10.1</b> Compute separation indices</a></li>
<li class="chapter" data-level="10.10.2" data-path="biological_function.html"><a href="biological_function.html#investigate-sign-scores-1"><i class="fa fa-check"></i><b>10.10.2</b> Investigate sign scores</a></li>
</ul></li>
<li class="chapter" data-level="10.11" data-path="biological_function.html"><a href="biological_function.html#investigate-batch-effects-1"><i class="fa fa-check"></i><b>10.11</b> Investigate batch effects</a></li>
<li class="chapter" data-level="10.12" data-path="biological_function.html"><a href="biological_function.html#spatial-mapping-by-spaniel-1"><i class="fa fa-check"></i><b>10.12</b> Spatial mapping by Spaniel</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="pathway.html"><a href="pathway.html"><i class="fa fa-check"></i><b>11</b> Inferring pathway activities (optional)</a>
<ul>
<li class="chapter" data-level="11.1" data-path="pathway.html"><a href="pathway.html#add-database-to-asurat-objects-2"><i class="fa fa-check"></i><b>11.1</b> Add database to ASURAT objects</a></li>
<li class="chapter" data-level="11.2" data-path="pathway.html"><a href="pathway.html#quick-qc-3"><i class="fa fa-check"></i><b>11.2</b> Quick QC</a></li>
<li class="chapter" data-level="11.3" data-path="pathway.html"><a href="pathway.html#correlation-graph-based-decomposition-2"><i class="fa fa-check"></i><b>11.3</b> Correlation graph-based decomposition</a></li>
<li class="chapter" data-level="11.4" data-path="pathway.html"><a href="pathway.html#creating-systems-of-signs-2"><i class="fa fa-check"></i><b>11.4</b> Creating systems of signs</a></li>
<li class="chapter" data-level="11.5" data-path="pathway.html"><a href="pathway.html#removing-redundant-signs-2"><i class="fa fa-check"></i><b>11.5</b> Removing redundant signs</a></li>
<li class="chapter" data-level="11.6" data-path="pathway.html"><a href="pathway.html#creating-sign-by-sample-matrices-2"><i class="fa fa-check"></i><b>11.6</b> Creating sign-by-sample matrices</a></li>
<li class="chapter" data-level="11.7" data-path="pathway.html"><a href="pathway.html#dimensionality-reduction-2"><i class="fa fa-check"></i><b>11.7</b> Dimensionality reduction</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="pathway.html"><a href="pathway.html#principal-component-analysis-optional-2"><i class="fa fa-check"></i><b>11.7.1</b> Principal component analysis (optional)</a></li>
<li class="chapter" data-level="11.7.2" data-path="pathway.html"><a href="pathway.html#t-distributed-stochastic-neighbor-embedding-optional-2"><i class="fa fa-check"></i><b>11.7.2</b> t-distributed stochastic neighbor embedding (optional)</a></li>
<li class="chapter" data-level="11.7.3" data-path="pathway.html"><a href="pathway.html#uniform-manifold-approximation-and-projection-optional-2"><i class="fa fa-check"></i><b>11.7.3</b> Uniform manifold approximation and projection (optional)</a></li>
<li class="chapter" data-level="11.7.4" data-path="pathway.html"><a href="pathway.html#diffusion-map-optional-2"><i class="fa fa-check"></i><b>11.7.4</b> Diffusion map (optional)</a></li>
<li class="chapter" data-level="11.7.5" data-path="pathway.html"><a href="pathway.html#visualization-2"><i class="fa fa-check"></i><b>11.7.5</b> Visualization</a></li>
<li class="chapter" data-level="11.7.6" data-path="pathway.html"><a href="pathway.html#save-results.-2"><i class="fa fa-check"></i><b>11.7.6</b> Save results.</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="pathway.html"><a href="pathway.html#cell-clustering-2"><i class="fa fa-check"></i><b>11.8</b> Cell clustering</a>
<ul>
<li class="chapter" data-level="11.8.1" data-path="pathway.html"><a href="pathway.html#partitioning-around-medoids-pam-optional-2"><i class="fa fa-check"></i><b>11.8.1</b> Partitioning around medoids (PAM) (optional)</a></li>
<li class="chapter" data-level="11.8.2" data-path="pathway.html"><a href="pathway.html#hierarchical-clustering-and-cutting-tree-optional-2"><i class="fa fa-check"></i><b>11.8.2</b> Hierarchical clustering and cutting tree (optional)</a></li>
<li class="chapter" data-level="11.8.3" data-path="pathway.html"><a href="pathway.html#community-detection-algorithm-with-k-nearest-neighbor-knn-graph-optional-2"><i class="fa fa-check"></i><b>11.8.3</b> Community detection algorithm with k-nearest neighbor (KNN) graph (optional)</a></li>
<li class="chapter" data-level="11.8.4" data-path="pathway.html"><a href="pathway.html#clustering-by-branch-detection-along-pseudotime-optional-2"><i class="fa fa-check"></i><b>11.8.4</b> Clustering by branch detection along pseudotime (optional)</a></li>
<li class="chapter" data-level="11.8.5" data-path="pathway.html"><a href="pathway.html#save-data-2"><i class="fa fa-check"></i><b>11.8.5</b> Save data</a></li>
</ul></li>
<li class="chapter" data-level="11.9" data-path="pathway.html"><a href="pathway.html#visualize-clustering-results-2"><i class="fa fa-check"></i><b>11.9</b> Visualize clustering results</a></li>
<li class="chapter" data-level="11.10" data-path="pathway.html"><a href="pathway.html#find-significant-signs-2"><i class="fa fa-check"></i><b>11.10</b> Find significant signs</a>
<ul>
<li class="chapter" data-level="11.10.1" data-path="pathway.html"><a href="pathway.html#compute-separation-indices-2"><i class="fa fa-check"></i><b>11.10.1</b> Compute separation indices</a></li>
<li class="chapter" data-level="11.10.2" data-path="pathway.html"><a href="pathway.html#investigate-sign-scores-2"><i class="fa fa-check"></i><b>11.10.2</b> Investigate sign scores</a></li>
</ul></li>
<li class="chapter" data-level="11.11" data-path="pathway.html"><a href="pathway.html#investigate-batch-effects-2"><i class="fa fa-check"></i><b>11.11</b> Investigate batch effects</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multi_layered.html"><a href="multi_layered.html"><i class="fa fa-check"></i><b>12</b> Multi-layered analysis across all the signs</a>
<ul>
<li class="chapter" data-level="12.1" data-path="multi_layered.html"><a href="multi_layered.html#concatenate-asurat-objects"><i class="fa fa-check"></i><b>12.1</b> Concatenate ASURAT objects</a></li>
<li class="chapter" data-level="12.2" data-path="multi_layered.html"><a href="multi_layered.html#find-significant-signs-and-genes-across-different-data-types"><i class="fa fa-check"></i><b>12.2</b> Find significant signs and genes across different data types</a></li>
<li class="chapter" data-level="12.3" data-path="multi_layered.html"><a href="multi_layered.html#spatial-mapping-by-spaniel-2"><i class="fa fa-check"></i><b>12.3</b> Spatial mapping by Spaniel</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html"><a href="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html"><i class="fa fa-check"></i><b>13</b> Appendix A: analyzing scRNA-seq data by existing method I</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html"><a href="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html#preprocessing"><i class="fa fa-check"></i><b>13.1</b> Preprocessing</a></li>
<li class="chapter" data-level="13.2" data-path="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html"><a href="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html#cluster-cells"><i class="fa fa-check"></i><b>13.2</b> Cluster cells</a></li>
<li class="chapter" data-level="13.3" data-path="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html"><a href="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html#visualize-data-in-low-dimensional-space"><i class="fa fa-check"></i><b>13.3</b> Visualize data in low dimensional space</a></li>
<li class="chapter" data-level="13.4" data-path="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html"><a href="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html#find-differentially-expressed-genes"><i class="fa fa-check"></i><b>13.4</b> Find differentially expressed genes</a></li>
<li class="chapter" data-level="13.5" data-path="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html"><a href="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html#save-results-1"><i class="fa fa-check"></i><b>13.5</b> Save results</a></li>
<li class="chapter" data-level="13.6" data-path="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html"><a href="appendix-a-analyzing-scrna-seq-data-by-existing-method-i.html#infer-cell-types-for-pbmc-datasets"><i class="fa fa-check"></i><b>13.6</b> Infer cell types for PBMC datasets</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><i class="fa fa-check"></i><b>14</b> Appendix B: analyzing scRNA-seq data by existing method II</a>
<ul>
<li class="chapter" data-level="14.1" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html#preprocessing-1"><i class="fa fa-check"></i><b>14.1</b> Preprocessing</a></li>
<li class="chapter" data-level="14.2" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html#cluster-cells-1"><i class="fa fa-check"></i><b>14.2</b> Cluster cells</a></li>
<li class="chapter" data-level="14.3" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html#visualize-data-in-low-dimensional-space-1"><i class="fa fa-check"></i><b>14.3</b> Visualize data in low dimensional space</a></li>
<li class="chapter" data-level="14.4" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html#cell-cycle-scoring"><i class="fa fa-check"></i><b>14.4</b> Cell cycle scoring</a></li>
<li class="chapter" data-level="14.5" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html#find-differentially-expressed-genes-1"><i class="fa fa-check"></i><b>14.5</b> Find differentially expressed genes</a></li>
<li class="chapter" data-level="14.6" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html#enrichment-analysis"><i class="fa fa-check"></i><b>14.6</b> Enrichment analysis</a></li>
<li class="chapter" data-level="14.7" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html#save-results-2"><i class="fa fa-check"></i><b>14.7</b> Save results</a></li>
<li class="chapter" data-level="14.8" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html#infer-cell-types-for-pbmc-datasets-1"><i class="fa fa-check"></i><b>14.8</b> Infer cell types for PBMC datasets</a></li>
<li class="chapter" data-level="14.9" data-path="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html"><a href="appendix-b-analyzing-scrna-seq-data-by-existing-method-ii.html#infer-cell-types-for-pbmc-datasets-by-seurat-and-sccatch"><i class="fa fa-check"></i><b>14.9</b> Infer cell types for PBMC datasets by Seurat and scCATCH</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html"><a href="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html"><i class="fa fa-check"></i><b>15</b> Appendix C: analyzing scRNA-seq data by existing method III</a>
<ul>
<li class="chapter" data-level="15.1" data-path="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html"><a href="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html#preprocessing-2"><i class="fa fa-check"></i><b>15.1</b> Preprocessing</a></li>
<li class="chapter" data-level="15.2" data-path="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html"><a href="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html#cluster-cells-2"><i class="fa fa-check"></i><b>15.2</b> Cluster cells</a></li>
<li class="chapter" data-level="15.3" data-path="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html"><a href="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html#visualize-data-in-low-dimensional-space-2"><i class="fa fa-check"></i><b>15.3</b> Visualize data in low dimensional space</a></li>
<li class="chapter" data-level="15.4" data-path="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html"><a href="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html#find-differentially-expressed-genes-2"><i class="fa fa-check"></i><b>15.4</b> Find differentially expressed genes</a></li>
<li class="chapter" data-level="15.5" data-path="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html"><a href="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html#save-results-3"><i class="fa fa-check"></i><b>15.5</b> Save results</a></li>
<li class="chapter" data-level="15.6" data-path="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html"><a href="appendix-c-analyzing-scrna-seq-data-by-existing-method-iii.html#infer-cell-types-for-pbmc-datasets-2"><i class="fa fa-check"></i><b>15.6</b> Infer cell types for PBMC datasets</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html"><a href="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html"><i class="fa fa-check"></i><b>16</b> Appendix D: analyzing scRNA-seq data by existing method IV</a>
<ul>
<li class="chapter" data-level="16.1" data-path="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html"><a href="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html#preprocessing-3"><i class="fa fa-check"></i><b>16.1</b> Preprocessing</a></li>
<li class="chapter" data-level="16.2" data-path="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html"><a href="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html#cluster-cells-3"><i class="fa fa-check"></i><b>16.2</b> Cluster cells</a></li>
<li class="chapter" data-level="16.3" data-path="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html"><a href="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html#find-differentially-expressed-genes-3"><i class="fa fa-check"></i><b>16.3</b> Find differentially expressed genes</a></li>
<li class="chapter" data-level="16.4" data-path="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html"><a href="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html#save-results-4"><i class="fa fa-check"></i><b>16.4</b> Save results</a></li>
<li class="chapter" data-level="16.5" data-path="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html"><a href="appendix-d-analyzing-scrna-seq-data-by-existing-method-iv.html#infer-cell-types-for-pbmc-datasets-3"><i class="fa fa-check"></i><b>16.5</b> Infer cell types for PBMC datasets</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="appendix-e-analyzing-scrna-seq-data-using-asurat.html"><a href="appendix-e-analyzing-scrna-seq-data-using-asurat.html"><i class="fa fa-check"></i><b>17</b> Appendix E: analyzing scRNA-seq data using ASURAT</a>
<ul>
<li class="chapter" data-level="17.1" data-path="appendix-e-analyzing-scrna-seq-data-using-asurat.html"><a href="appendix-e-analyzing-scrna-seq-data-using-asurat.html#infer-cell-types-for-pbmc-datasets-4"><i class="fa fa-check"></i><b>17.1</b> Infer cell types for PBMC datasets</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="appendix-f-creating-figures.html"><a href="appendix-f-creating-figures.html"><i class="fa fa-check"></i><b>18</b> Appendix F: creating figures</a>
<ul>
<li class="chapter" data-level="18.1" data-path="appendix-f-creating-figures.html"><a href="appendix-f-creating-figures.html#pbmcs-datasets"><i class="fa fa-check"></i><b>18.1</b> PBMCs datasets</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="appendix-f-creating-figures.html"><a href="appendix-f-creating-figures.html#multi-layered-analysis"><i class="fa fa-check"></i><b>18.1.1</b> Multi-layered analysis</a></li>
<li class="chapter" data-level="18.1.2" data-path="appendix-f-creating-figures.html"><a href="appendix-f-creating-figures.html#infer-population-ratios"><i class="fa fa-check"></i><b>18.1.2</b> Infer population ratios</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="appendix-f-creating-figures.html"><a href="appendix-f-creating-figures.html#lung-cancer-dataset"><i class="fa fa-check"></i><b>18.2</b> Lung cancer dataset</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="appendix-f-creating-figures.html"><a href="appendix-f-creating-figures.html#heatmaps-of-marker-gene-expressions"><i class="fa fa-check"></i><b>18.2.1</b> Heatmaps of marker gene expressions</a></li>
<li class="chapter" data-level="18.2.2" data-path="appendix-f-creating-figures.html"><a href="appendix-f-creating-figures.html#multi-layered-analysis-1"><i class="fa fa-check"></i><b>18.2.2</b> Multi-layered analysis</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="appendix-f-creating-figures.html"><a href="appendix-f-creating-figures.html#pancreatic-ductal-adenocarcinoma-pdac-datasets"><i class="fa fa-check"></i><b>18.3</b> Pancreatic ductal adenocarcinoma (PDAC) datasets</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="appendix-f-creating-figures.html"><a href="appendix-f-creating-figures.html#clustering-pdac-spatial-transcriptomes"><i class="fa fa-check"></i><b>18.3.1</b> Clustering PDAC spatial transcriptomes</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to ASURAT (version 0.0.0.9001)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="biological_function" class="section level1" number="10">
<h1><span class="header-section-number">Chapter 10</span> Inferring biological functions (optional)</h1>
<p>In this section, we infer biological functions for individual cells using ASURAT
by inputting Gene Ontology database.</p>
<p>ASURAT transforms normalized and centered read count tables to cell-type or
functional spectrum matrix, which we term sign-by-sample matrices (SSMs).
The resulting matrices can be supplied to the subsequent unsupervised
clusterings.</p>
<div id="add-database-to-asurat-objects-1" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Add database to ASURAT objects</h2>
<p>Load the data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="biological_function.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="biological_function.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/plot.R&quot;</span>)</span>
<span id="cb1-3"><a href="biological_function.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/function_asurat.R&quot;</span>)</span>
<span id="cb1-4"><a href="biological_function.html#cb1-4" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/01_005_sc68_vehi_normalized.rds&quot;</span>)</span>
<span id="cb1-5"><a href="biological_function.html#cb1-5" aria-hidden="true" tabindex="-1"></a>sc68_cisp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/02_005_sc68_cisp_normalized.rds&quot;</span>)</span>
<span id="cb1-6"><a href="biological_function.html#cb1-6" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_005_pdac_aint_normalized.rds&quot;</span>)</span>
<span id="cb1-7"><a href="biological_function.html#cb1-7" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/10_005_pbmc_4000_normalized.rds&quot;</span>)</span>
<span id="cb1-8"><a href="biological_function.html#cb1-8" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/11_005_pbmc_6000_normalized.rds&quot;</span>)</span>
<span id="cb1-9"><a href="biological_function.html#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="biological_function.html#cb1-10" aria-hidden="true" tabindex="-1"></a>sc68_vehi_cor <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/01_006_sc68_vehi_correlation.rds&quot;</span>)</span>
<span id="cb1-11"><a href="biological_function.html#cb1-11" aria-hidden="true" tabindex="-1"></a>sc68_cisp_cor <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/02_006_sc68_cisp_correlation.rds&quot;</span>)</span>
<span id="cb1-12"><a href="biological_function.html#cb1-12" aria-hidden="true" tabindex="-1"></a>pdac_aint_cor <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_006_pdac_aint_correlation.rds&quot;</span>)</span>
<span id="cb1-13"><a href="biological_function.html#cb1-13" aria-hidden="true" tabindex="-1"></a>pbmc_4000_cor <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/10_006_pbmc_4000_correlation.rds&quot;</span>)</span>
<span id="cb1-14"><a href="biological_function.html#cb1-14" aria-hidden="true" tabindex="-1"></a>pbmc_6000_cor <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/11_006_pbmc_6000_correlation.rds&quot;</span>)</span></code></pre></div>
<p>Load Gene Ontology (GO) database.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="biological_function.html#cb2-1" aria-hidden="true" tabindex="-1"></a>tidy_GO <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;data/2020_001_databases/20201213_tidy_GO_human.rds&quot;</span>)</span></code></pre></div>
<p>See that GO has categories MF, BP, and CC.</p>
<p>Load the tables of information contents.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="biological_function.html#cb3-1" aria-hidden="true" tabindex="-1"></a>IC_GO <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;data/2020_001_databases/20201213_IC_GO_human.rds&quot;</span>)</span></code></pre></div>
<p>To make the object small, unused items are removed.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="biological_function.html#cb4-1" aria-hidden="true" tabindex="-1"></a>myfunc <span class="ot">&lt;-</span> <span class="cf">function</span>(obj){</span>
<span id="cb4-2"><a href="biological_function.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  obj[[<span class="st">&quot;data&quot;</span>]][[<span class="st">&quot;raw&quot;</span>]] <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-3"><a href="biological_function.html#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(obj)</span>
<span id="cb4-4"><a href="biological_function.html#cb4-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-5"><a href="biological_function.html#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="biological_function.html#cb4-6" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">myfunc</span>(sc68_vehi)</span>
<span id="cb4-7"><a href="biological_function.html#cb4-7" aria-hidden="true" tabindex="-1"></a>sc68_cisp <span class="ot">&lt;-</span> <span class="fu">myfunc</span>(sc68_cisp)</span>
<span id="cb4-8"><a href="biological_function.html#cb4-8" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">myfunc</span>(pdac_aint)</span>
<span id="cb4-9"><a href="biological_function.html#cb4-9" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">myfunc</span>(pbmc_4000)</span>
<span id="cb4-10"><a href="biological_function.html#cb4-10" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">myfunc</span>(pbmc_6000)</span></code></pre></div>
<p>Add formatted databases into ASURAT objects.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="biological_function.html#cb5-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi[[<span class="st">&quot;sign&quot;</span>]][[<span class="st">&quot;GO&quot;</span>]] <span class="ot">&lt;-</span> tidy_GO</span>
<span id="cb5-2"><a href="biological_function.html#cb5-2" aria-hidden="true" tabindex="-1"></a>sc68_cisp[[<span class="st">&quot;sign&quot;</span>]][[<span class="st">&quot;GO&quot;</span>]] <span class="ot">&lt;-</span> tidy_GO</span>
<span id="cb5-3"><a href="biological_function.html#cb5-3" aria-hidden="true" tabindex="-1"></a>pdac_aint[[<span class="st">&quot;sign&quot;</span>]][[<span class="st">&quot;GO&quot;</span>]] <span class="ot">&lt;-</span> tidy_GO</span>
<span id="cb5-4"><a href="biological_function.html#cb5-4" aria-hidden="true" tabindex="-1"></a>pbmc_4000[[<span class="st">&quot;sign&quot;</span>]][[<span class="st">&quot;GO&quot;</span>]] <span class="ot">&lt;-</span> tidy_GO</span>
<span id="cb5-5"><a href="biological_function.html#cb5-5" aria-hidden="true" tabindex="-1"></a>pbmc_6000[[<span class="st">&quot;sign&quot;</span>]][[<span class="st">&quot;GO&quot;</span>]] <span class="ot">&lt;-</span> tidy_GO</span></code></pre></div>
</div>
<div id="quick-qc-2" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Quick QC</h2>
<p>The following function <code>do_quickQC_sign()</code> takes an intersection of genes
between user’s scRNA-seq data and collected database, and then excludes the IDs
including too few or too many genes by setting thresholds <code>min_ngenes</code>
(minimal number of genes which must be greater than one) and <code>max_ngenes</code>
(maximal number of genes which must be greater than one).
Here, the values of <code>min_ngenes</code> and <code>max_ngenes</code> were set as 2 and 1000,
respectively, as default values.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="biological_function.html#cb6-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">do_quickQC_sign</span>(<span class="at">obj =</span> sc68_vehi, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb6-2"><a href="biological_function.html#cb6-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_ngenes =</span> <span class="dv">2</span>, <span class="at">max_ngenes =</span> <span class="dv">1000</span>)</span>
<span id="cb6-3"><a href="biological_function.html#cb6-3" aria-hidden="true" tabindex="-1"></a>sc68_cisp <span class="ot">&lt;-</span> <span class="fu">do_quickQC_sign</span>(<span class="at">obj =</span> sc68_cisp, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb6-4"><a href="biological_function.html#cb6-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_ngenes =</span> <span class="dv">2</span>, <span class="at">max_ngenes =</span> <span class="dv">1000</span>)</span>
<span id="cb6-5"><a href="biological_function.html#cb6-5" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">do_quickQC_sign</span>(<span class="at">obj =</span> pdac_aint, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb6-6"><a href="biological_function.html#cb6-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_ngenes =</span> <span class="dv">2</span>, <span class="at">max_ngenes =</span> <span class="dv">1000</span>)</span>
<span id="cb6-7"><a href="biological_function.html#cb6-7" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">do_quickQC_sign</span>(<span class="at">obj =</span> pbmc_4000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb6-8"><a href="biological_function.html#cb6-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_ngenes =</span> <span class="dv">2</span>, <span class="at">max_ngenes =</span> <span class="dv">1000</span>)</span>
<span id="cb6-9"><a href="biological_function.html#cb6-9" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">do_quickQC_sign</span>(<span class="at">obj =</span> pbmc_6000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb6-10"><a href="biological_function.html#cb6-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_ngenes =</span> <span class="dv">2</span>, <span class="at">max_ngenes =</span> <span class="dv">1000</span>)</span></code></pre></div>
<p>The results are stored in <code>obj[["sign"]][[data_type]][[category]]</code>.</p>
</div>
<div id="correlation-graph-based-decomposition-1" class="section level2" number="10.3">
<h2><span class="header-section-number">10.3</span> Correlation graph-based decomposition</h2>
<p>The following function <code>separate_variables_sign()</code> clusters each functional
gene set into three groups, i.e., strongly correlated gene set (SCG),
variably correlated gene set (VCG), and weakly correlated gene set (WCG).
The arguments are <code>obj</code> (ASURAT object), <code>obj_cor</code>, <code>data_type</code>,
<code>method = "spearman"</code> (one of <code>names(obj_cor)</code>), <code>th_posi</code>, and <code>th_nega</code>
(thresholds of positive and negative correlation coefficients, respectively).</p>
<p><strong>Tips:</strong>
This function sometimes produces unexpected results.
In fact, the smaller values of <code>th_posi</code> and <code>th_nega</code> do not always result in
the larger sizes of SCG and VCG.
Hence we recommend users to carefully turn the parameters and check if the
biological terms (i.e., signs) of interest are included in the results.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="biological_function.html#cb7-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi_red <span class="ot">&lt;-</span> <span class="fu">separate_variables_sign</span>(<span class="at">obj =</span> sc68_vehi,</span>
<span id="cb7-2"><a href="biological_function.html#cb7-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">obj_cor =</span> sc68_vehi_cor,</span>
<span id="cb7-3"><a href="biological_function.html#cb7-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>,</span>
<span id="cb7-4"><a href="biological_function.html#cb7-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">th_posi =</span> <span class="fl">0.49</span>, <span class="at">th_nega =</span> <span class="sc">-</span><span class="fl">0.39</span>)</span>
<span id="cb7-5"><a href="biological_function.html#cb7-5" aria-hidden="true" tabindex="-1"></a>sc68_cisp_red <span class="ot">&lt;-</span> <span class="fu">separate_variables_sign</span>(<span class="at">obj =</span> sc68_cisp,</span>
<span id="cb7-6"><a href="biological_function.html#cb7-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">obj_cor =</span> sc68_cisp_cor,</span>
<span id="cb7-7"><a href="biological_function.html#cb7-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>,</span>
<span id="cb7-8"><a href="biological_function.html#cb7-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">th_posi =</span> <span class="fl">0.34</span>, <span class="at">th_nega =</span> <span class="sc">-</span><span class="fl">0.20</span>)</span>
<span id="cb7-9"><a href="biological_function.html#cb7-9" aria-hidden="true" tabindex="-1"></a>pdac_aint_red <span class="ot">&lt;-</span> <span class="fu">separate_variables_sign</span>(<span class="at">obj =</span> pdac_aint,</span>
<span id="cb7-10"><a href="biological_function.html#cb7-10" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">obj_cor =</span> pdac_aint_cor,</span>
<span id="cb7-11"><a href="biological_function.html#cb7-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>,</span>
<span id="cb7-12"><a href="biological_function.html#cb7-12" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">th_posi =</span> <span class="fl">0.26</span>, <span class="at">th_nega =</span> <span class="sc">-</span><span class="fl">0.30</span>)</span>
<span id="cb7-13"><a href="biological_function.html#cb7-13" aria-hidden="true" tabindex="-1"></a>pbmc_4000_red <span class="ot">&lt;-</span> <span class="fu">separate_variables_sign</span>(<span class="at">obj =</span> pbmc_4000,</span>
<span id="cb7-14"><a href="biological_function.html#cb7-14" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">obj_cor =</span> pbmc_4000_cor,</span>
<span id="cb7-15"><a href="biological_function.html#cb7-15" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>,</span>
<span id="cb7-16"><a href="biological_function.html#cb7-16" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">th_posi =</span> <span class="fl">0.25</span>, <span class="at">th_nega =</span> <span class="sc">-</span><span class="fl">0.25</span>)</span>
<span id="cb7-17"><a href="biological_function.html#cb7-17" aria-hidden="true" tabindex="-1"></a>pbmc_6000_red <span class="ot">&lt;-</span> <span class="fu">separate_variables_sign</span>(<span class="at">obj =</span> pbmc_6000,</span>
<span id="cb7-18"><a href="biological_function.html#cb7-18" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">obj_cor =</span> pbmc_6000_cor,</span>
<span id="cb7-19"><a href="biological_function.html#cb7-19" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>,</span>
<span id="cb7-20"><a href="biological_function.html#cb7-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">th_posi =</span> <span class="fl">0.25</span>, <span class="at">th_nega =</span> <span class="sc">-</span><span class="fl">0.22</span>)</span></code></pre></div>
<p>The result is stored in <code>obj[["sign"]][[data_type]][[category]]</code>.</p>
</div>
<div id="creating-systems-of-signs-1" class="section level2" number="10.4">
<h2><span class="header-section-number">10.4</span> Creating systems of signs</h2>
<p>The following function <code>select_sign()</code> selects the signs by a user-defined
criteria, which has been preset as follows:</p>
<ol style="list-style-type: decimal">
<li>sum of the number of genes in SCG and VCG is greater than or equal to
<code>min_cnt</code>, and</li>
<li>the number of genes in WCG is greater than or equal to <code>min_cnt_weak</code>
(the default value is 2).</li>
</ol>
<p>Users can modify the programming code indicated by “User-defined criteria”
in the file <code>R/function_asurat.R</code>.
Note that the signs having at most one gene will be removed when creating
sign-by-sample matrices.
For example, given a certain parent sign having SCG = {GENE_A, GENE_B} and
VCG = {GENE_C}, the VCG will be removed from the downstream analysis.</p>
<p><strong>Tips:</strong>
The larger the value of <code>min_cnt</code> is, the more reliable signs users can obtain.
However, one should pay attention to several bias problems such as annotation
bias, that is some biological terms are associated with many genes, while
others with few.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="biological_function.html#cb8-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi_red <span class="ot">&lt;-</span> <span class="fu">select_sign</span>(<span class="at">obj =</span> sc68_vehi_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb8-2"><a href="biological_function.html#cb8-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_cnt =</span> <span class="dv">4</span>, <span class="at">min_cnt_weak =</span> <span class="dv">2</span>)</span>
<span id="cb8-3"><a href="biological_function.html#cb8-3" aria-hidden="true" tabindex="-1"></a>sc68_cisp_red <span class="ot">&lt;-</span> <span class="fu">select_sign</span>(<span class="at">obj =</span> sc68_cisp_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb8-4"><a href="biological_function.html#cb8-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_cnt =</span> <span class="dv">4</span>, <span class="at">min_cnt_weak =</span> <span class="dv">2</span>)</span>
<span id="cb8-5"><a href="biological_function.html#cb8-5" aria-hidden="true" tabindex="-1"></a>pdac_aint_red <span class="ot">&lt;-</span> <span class="fu">select_sign</span>(<span class="at">obj =</span> pdac_aint_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb8-6"><a href="biological_function.html#cb8-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_cnt =</span> <span class="dv">3</span>, <span class="at">min_cnt_weak =</span> <span class="dv">2</span>)</span>
<span id="cb8-7"><a href="biological_function.html#cb8-7" aria-hidden="true" tabindex="-1"></a>pbmc_4000_red <span class="ot">&lt;-</span> <span class="fu">select_sign</span>(<span class="at">obj =</span> pbmc_4000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb8-8"><a href="biological_function.html#cb8-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_cnt =</span> <span class="dv">4</span>, <span class="at">min_cnt_weak =</span> <span class="dv">2</span>)</span>
<span id="cb8-9"><a href="biological_function.html#cb8-9" aria-hidden="true" tabindex="-1"></a>pbmc_6000_red <span class="ot">&lt;-</span> <span class="fu">select_sign</span>(<span class="at">obj =</span> pbmc_6000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb8-10"><a href="biological_function.html#cb8-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">min_cnt =</span> <span class="dv">4</span>, <span class="at">min_cnt_weak =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The result is stored in <code>obj[["sign"]][[data_type]][[category]]</code>.</p>
<p>Save the objects.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="biological_function.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sc68_vehi_red, <span class="at">file =</span> <span class="st">&quot;backup/01_100_sc68_vehi_select_GO.rds&quot;</span>)</span>
<span id="cb9-2"><a href="biological_function.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sc68_cisp_red, <span class="at">file =</span> <span class="st">&quot;backup/02_100_sc68_cisp_select_GO.rds&quot;</span>)</span>
<span id="cb9-3"><a href="biological_function.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pdac_aint_red, <span class="at">file =</span> <span class="st">&quot;backup/07_100_pdac_aint_select_GO.rds&quot;</span>)</span>
<span id="cb9-4"><a href="biological_function.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_4000_red, <span class="at">file =</span> <span class="st">&quot;backup/10_100_pbmc_4000_select_GO.rds&quot;</span>)</span>
<span id="cb9-5"><a href="biological_function.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_6000_red, <span class="at">file =</span> <span class="st">&quot;backup/11_100_pbmc_6000_select_GO.rds&quot;</span>)</span></code></pre></div>
<p>Load the objects.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="biological_function.html#cb10-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi_red <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/01_100_sc68_vehi_select_GO.rds&quot;</span>)</span>
<span id="cb10-2"><a href="biological_function.html#cb10-2" aria-hidden="true" tabindex="-1"></a>sc68_cisp_red <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/02_100_sc68_cisp_select_GO.rds&quot;</span>)</span>
<span id="cb10-3"><a href="biological_function.html#cb10-3" aria-hidden="true" tabindex="-1"></a>pdac_aint_red <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_100_pdac_aint_select_GO.rds&quot;</span>)</span>
<span id="cb10-4"><a href="biological_function.html#cb10-4" aria-hidden="true" tabindex="-1"></a>pbmc_4000_red <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/10_100_pbmc_4000_select_GO.rds&quot;</span>)</span>
<span id="cb10-5"><a href="biological_function.html#cb10-5" aria-hidden="true" tabindex="-1"></a>pbmc_6000_red <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/11_100_pbmc_6000_select_GO.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="removing-redundant-signs-1" class="section level2" number="10.5">
<h2><span class="header-section-number">10.5</span> Removing redundant signs</h2>
<p>The following function <code>compute_SemSim_sign()</code> computes pairwise semantic
similarities between biological terms.
Note that this function can be used only for ontology databases such as
DO, CO, and GO.
The arguments are <code>obj</code>, <code>data_type</code>, <code>measure</code> (see below),
<code>orgdb</code> (this is necessary only for GO analysis, otherwise <code>NULL</code>),
<code>treeTable</code> (this is necessary only for CO, otherwise <code>NULL</code>), and
<code>IC</code> (information contents: this is necessary only for DO, CO, and GO).
Here <code>measure</code> must be chosen as follows:</p>
<ul>
<li>DO: one of <code>"Wang"</code>, <code>"Resnik"</code>, <code>"Rel"</code>, <code>"Jiang"</code>, and <code>"Lin"</code>;</li>
<li>CO: one of <code>"Lin"</code> and <code>"Resnik"</code>; and</li>
<li>GO: one of <code>"Resnik"</code>, <code>"Rel"</code>, <code>"Jiang"</code>, and <code>"Lin"</code>.</li>
</ul>
<p><strong>Tips:</strong>
The similarity between biological terms are computed based on <code>measure</code>, and
the optimal choice depends on the ontology structure.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="biological_function.html#cb11-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi_red <span class="ot">&lt;-</span> <span class="fu">compute_SemSim_sign</span>(<span class="at">obj =</span> sc68_vehi_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb11-2"><a href="biological_function.html#cb11-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">measure =</span> <span class="st">&quot;Jiang&quot;</span>, <span class="at">orgdb =</span> org.Hs.eg.db,</span>
<span id="cb11-3"><a href="biological_function.html#cb11-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">treeTable =</span> <span class="cn">NULL</span>, <span class="at">IC =</span> IC_GO)</span>
<span id="cb11-4"><a href="biological_function.html#cb11-4" aria-hidden="true" tabindex="-1"></a>sc68_cisp_red <span class="ot">&lt;-</span> <span class="fu">compute_SemSim_sign</span>(<span class="at">obj =</span> sc68_cisp_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb11-5"><a href="biological_function.html#cb11-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">measure =</span> <span class="st">&quot;Jiang&quot;</span>, <span class="at">orgdb =</span> org.Hs.eg.db,</span>
<span id="cb11-6"><a href="biological_function.html#cb11-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">treeTable =</span> <span class="cn">NULL</span>, <span class="at">IC =</span> IC_GO)</span>
<span id="cb11-7"><a href="biological_function.html#cb11-7" aria-hidden="true" tabindex="-1"></a>pdac_aint_red <span class="ot">&lt;-</span> <span class="fu">compute_SemSim_sign</span>(<span class="at">obj =</span> pdac_aint_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb11-8"><a href="biological_function.html#cb11-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">measure =</span> <span class="st">&quot;Jiang&quot;</span>, <span class="at">orgdb =</span> org.Hs.eg.db,</span>
<span id="cb11-9"><a href="biological_function.html#cb11-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">treeTable =</span> <span class="cn">NULL</span>, <span class="at">IC =</span> IC_GO)</span>
<span id="cb11-10"><a href="biological_function.html#cb11-10" aria-hidden="true" tabindex="-1"></a>pbmc_4000_red <span class="ot">&lt;-</span> <span class="fu">compute_SemSim_sign</span>(<span class="at">obj =</span> pbmc_4000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb11-11"><a href="biological_function.html#cb11-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">measure =</span> <span class="st">&quot;Jiang&quot;</span>, <span class="at">orgdb =</span> org.Hs.eg.db,</span>
<span id="cb11-12"><a href="biological_function.html#cb11-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">treeTable =</span> <span class="cn">NULL</span>, <span class="at">IC =</span> IC_GO)</span>
<span id="cb11-13"><a href="biological_function.html#cb11-13" aria-hidden="true" tabindex="-1"></a>pbmc_6000_red <span class="ot">&lt;-</span> <span class="fu">compute_SemSim_sign</span>(<span class="at">obj =</span> pbmc_6000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb11-14"><a href="biological_function.html#cb11-14" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">measure =</span> <span class="st">&quot;Jiang&quot;</span>, <span class="at">orgdb =</span> org.Hs.eg.db,</span>
<span id="cb11-15"><a href="biological_function.html#cb11-15" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">treeTable =</span> <span class="cn">NULL</span>, <span class="at">IC =</span> IC_GO)</span></code></pre></div>
<p>The results are stored in <code>obj[["sign"]][["data_type_Sim"]]</code>.
Note that the row and column names are in ascending order with respect to the
values of information content (IC).</p>
<p>The following function <code>reduce_sign()</code> removes the biological terms based on the
results of <code>compute_SemSim_sign()</code>.
The arguments are <code>obj</code>, <code>data_type</code>, <code>threshold</code> (threshold for regarding
two biological terms as similar ones), and <code>keep_rareID</code> (if <code>"TRUE"</code>, then the
biological terms with larger ICs are kept).
Note that the larger ICs are, the deeper the biological terms tend to be.
Users can access a correspondence table in <code>obj[["sign"]][["data_type_Sim"]]</code>,
where SCG, VCG, and WCG are separated by <code>||</code>.</p>
<p><strong>Tips:</strong>
The optimal value of <code>threshold</code> depends on the ontology structure as well as
the measure used in <code>compute_SemSim_sign()</code>.
The logical argument <code>keep_rareID</code> should be carefully determined by the
research objective.
For example, if users are interested in detailed information,
it might be <code>keep_rareID = TRUE</code>.
Note that the smaller ICs are, the more genes tend to be associated with.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="biological_function.html#cb12-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi_red <span class="ot">&lt;-</span> <span class="fu">reduce_sign</span>(<span class="at">obj =</span> sc68_vehi_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb12-2"><a href="biological_function.html#cb12-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">threshold =</span> <span class="fl">0.80</span>, <span class="at">keep_rareID =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="biological_function.html#cb12-3" aria-hidden="true" tabindex="-1"></a>sc68_cisp_red <span class="ot">&lt;-</span> <span class="fu">reduce_sign</span>(<span class="at">obj =</span> sc68_cisp_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb12-4"><a href="biological_function.html#cb12-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">threshold =</span> <span class="fl">0.80</span>, <span class="at">keep_rareID =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-5"><a href="biological_function.html#cb12-5" aria-hidden="true" tabindex="-1"></a>pdac_aint_red <span class="ot">&lt;-</span> <span class="fu">reduce_sign</span>(<span class="at">obj =</span> pdac_aint_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb12-6"><a href="biological_function.html#cb12-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">threshold =</span> <span class="fl">0.85</span>, <span class="at">keep_rareID =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-7"><a href="biological_function.html#cb12-7" aria-hidden="true" tabindex="-1"></a>pbmc_4000_red <span class="ot">&lt;-</span> <span class="fu">reduce_sign</span>(<span class="at">obj =</span> pbmc_4000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb12-8"><a href="biological_function.html#cb12-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">threshold =</span> <span class="fl">0.70</span>, <span class="at">keep_rareID =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-9"><a href="biological_function.html#cb12-9" aria-hidden="true" tabindex="-1"></a>pbmc_6000_red <span class="ot">&lt;-</span> <span class="fu">reduce_sign</span>(<span class="at">obj =</span> pbmc_6000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb12-10"><a href="biological_function.html#cb12-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">threshold =</span> <span class="fl">0.70</span>, <span class="at">keep_rareID =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>The results are stored in
<code>obj[["sign"]][["data_type_Sim"]][[category]][["report"]]</code>.</p>
<p>The following function <code>manual_exclusion_sign()</code> removes biological terms by
specifying IDs (e.g., <code>GOID:XXX</code>) or keywords (e.g., <code>oocyte</code>)
using grepl command.
The argument are <code>obj</code>, <code>data_type</code>, and <code>keywords</code> (list of keywords
separated by <code>|</code>).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="biological_function.html#cb13-1" aria-hidden="true" tabindex="-1"></a>keywords <span class="ot">&lt;-</span> <span class="st">&quot;foo|foofoo&quot;</span></span>
<span id="cb13-2"><a href="biological_function.html#cb13-2" aria-hidden="true" tabindex="-1"></a>sc68_vehi_red <span class="ot">&lt;-</span> <span class="fu">manual_exclusion_sign</span>(<span class="at">obj =</span> sc68_vehi_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb13-3"><a href="biological_function.html#cb13-3" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">keywords =</span> keywords)</span>
<span id="cb13-4"><a href="biological_function.html#cb13-4" aria-hidden="true" tabindex="-1"></a>keywords <span class="ot">&lt;-</span> <span class="st">&quot;foo|foofoo&quot;</span></span>
<span id="cb13-5"><a href="biological_function.html#cb13-5" aria-hidden="true" tabindex="-1"></a>sc68_cisp_red <span class="ot">&lt;-</span> <span class="fu">manual_exclusion_sign</span>(<span class="at">obj =</span> sc68_cisp_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb13-6"><a href="biological_function.html#cb13-6" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">keywords =</span> keywords)</span>
<span id="cb13-7"><a href="biological_function.html#cb13-7" aria-hidden="true" tabindex="-1"></a>keywords <span class="ot">&lt;-</span> <span class="st">&quot;foo|foofoo&quot;</span></span>
<span id="cb13-8"><a href="biological_function.html#cb13-8" aria-hidden="true" tabindex="-1"></a>pdac_aint_red <span class="ot">&lt;-</span> <span class="fu">manual_exclusion_sign</span>(<span class="at">obj =</span> pdac_aint_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb13-9"><a href="biological_function.html#cb13-9" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">keywords =</span> keywords)</span>
<span id="cb13-10"><a href="biological_function.html#cb13-10" aria-hidden="true" tabindex="-1"></a>keywords <span class="ot">&lt;-</span> <span class="st">&quot;foo|foofoo&quot;</span></span>
<span id="cb13-11"><a href="biological_function.html#cb13-11" aria-hidden="true" tabindex="-1"></a>pbmc_4000_red <span class="ot">&lt;-</span> <span class="fu">manual_exclusion_sign</span>(<span class="at">obj =</span> pbmc_4000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb13-12"><a href="biological_function.html#cb13-12" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">keywords =</span> keywords)</span>
<span id="cb13-13"><a href="biological_function.html#cb13-13" aria-hidden="true" tabindex="-1"></a>keywords <span class="ot">&lt;-</span> <span class="st">&quot;foo|foofoo&quot;</span></span>
<span id="cb13-14"><a href="biological_function.html#cb13-14" aria-hidden="true" tabindex="-1"></a>pbmc_6000_red <span class="ot">&lt;-</span> <span class="fu">manual_exclusion_sign</span>(<span class="at">obj =</span> pbmc_6000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb13-15"><a href="biological_function.html#cb13-15" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">keywords =</span> keywords)</span></code></pre></div>
<p>The results are stored in <code>obj[["sign"]][[data_type]][[category]]</code>.</p>
</div>
<div id="creating-sign-by-sample-matrices-1" class="section level2" number="10.6">
<h2><span class="header-section-number">10.6</span> Creating sign-by-sample matrices</h2>
<p>The following function <code>make_signxsample_matrix()</code> makes sign-by-sample
matrices.
The arguments are <code>obj</code>, <code>data_type</code>,
<code>weight_strg</code> (weight parameter for SCG: the default value is 0.5) and
<code>weight_vari</code> (weight parameter for VCG: the default value is 0.5).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="biological_function.html#cb14-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi_red <span class="ot">&lt;-</span> <span class="fu">make_signxsample_matrix</span>(<span class="at">obj =</span> sc68_vehi_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb14-2"><a href="biological_function.html#cb14-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">weight_strg =</span> <span class="fl">0.5</span>, <span class="at">weight_vari =</span> <span class="fl">0.5</span>)</span>
<span id="cb14-3"><a href="biological_function.html#cb14-3" aria-hidden="true" tabindex="-1"></a>sc68_cisp_red <span class="ot">&lt;-</span> <span class="fu">make_signxsample_matrix</span>(<span class="at">obj =</span> sc68_cisp_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb14-4"><a href="biological_function.html#cb14-4" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">weight_strg =</span> <span class="fl">0.5</span>, <span class="at">weight_vari =</span> <span class="fl">0.5</span>)</span>
<span id="cb14-5"><a href="biological_function.html#cb14-5" aria-hidden="true" tabindex="-1"></a>pdac_aint_red <span class="ot">&lt;-</span> <span class="fu">make_signxsample_matrix</span>(<span class="at">obj =</span> pdac_aint_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb14-6"><a href="biological_function.html#cb14-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">weight_strg =</span> <span class="fl">0.5</span>, <span class="at">weight_vari =</span> <span class="fl">0.5</span>)</span>
<span id="cb14-7"><a href="biological_function.html#cb14-7" aria-hidden="true" tabindex="-1"></a>pbmc_4000_red <span class="ot">&lt;-</span> <span class="fu">make_signxsample_matrix</span>(<span class="at">obj =</span> pbmc_4000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb14-8"><a href="biological_function.html#cb14-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">weight_strg =</span> <span class="fl">0.5</span>, <span class="at">weight_vari =</span> <span class="fl">0.5</span>)</span>
<span id="cb14-9"><a href="biological_function.html#cb14-9" aria-hidden="true" tabindex="-1"></a>pbmc_6000_red <span class="ot">&lt;-</span> <span class="fu">make_signxsample_matrix</span>(<span class="at">obj =</span> pbmc_6000_red, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb14-10"><a href="biological_function.html#cb14-10" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">weight_strg =</span> <span class="fl">0.5</span>, <span class="at">weight_vari =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p>The results are stored in <code>obj[["sign"]][["data_typexSample"]][[category]]</code>.</p>
<p>The following command <code>plot_Heatmap_SignxSamp()</code> plots a heat map by using
<code>Heatmap()</code> in <code>ComplexHeatmap</code> package applied to the sign-by-sample matrices.
The arguments are <code>obj</code>, <code>data_type</code>, <code>category</code>, <code>algo_name = NULL</code>,
<code>method</code> (agglomeration method to be used such as <code>complete</code>, <code>ward.D2</code>,
<code>average</code>, etc.), and <code>show_nReads</code> (if <code>TRUE</code>, the number of reads is shown).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="biological_function.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb15-2"><a href="biological_function.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sc68_vehi</span></span>
<span id="cb15-3"><a href="biological_function.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb15-4"><a href="biological_function.html#cb15-4" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_01_0200.png&quot;</span></span>
<span id="cb15-5"><a href="biological_function.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> filename, <span class="at">height =</span> <span class="dv">1000</span>, <span class="at">width =</span> <span class="dv">1150</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb15-6"><a href="biological_function.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Heatmap_SignxSamp</span>(<span class="at">obj =</span> sc68_vehi,</span>
<span id="cb15-7"><a href="biological_function.html#cb15-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb15-8"><a href="biological_function.html#cb15-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">algo_name =</span> <span class="cn">NULL</span>, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>,</span>
<span id="cb15-9"><a href="biological_function.html#cb15-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_nReads =</span> <span class="cn">FALSE</span>, <span class="at">title =</span> <span class="st">&quot;sc68_vehi (GO: BP)&quot;</span>,</span>
<span id="cb15-10"><a href="biological_function.html#cb15-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&quot;Sign score&quot;</span>, <span class="at">show_rownames_sign =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-11"><a href="biological_function.html#cb15-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_rownames_label =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-12"><a href="biological_function.html#cb15-12" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_rownames_nReads =</span> <span class="cn">FALSE</span>, <span class="at">default_color =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-13"><a href="biological_function.html#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figures/figure_01_0200.png" width="300px">
<img src="figures/figure_02_0200.png" width="300px">
<img src="figures/figure_07_0200.png" width="300px">
<img src="figures/figure_10_0200.png" width="300px">
<img src="figures/figure_11_0200.png" width="300px"></p>
<p>Save the objects.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="biological_function.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sc68_vehi_red, <span class="at">file =</span> <span class="st">&quot;backup/01_201_sc68_vehi_matrix_GO.rds&quot;</span>)</span>
<span id="cb16-2"><a href="biological_function.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sc68_cisp_red, <span class="at">file =</span> <span class="st">&quot;backup/02_201_sc68_cisp_matrix_GO.rds&quot;</span>)</span>
<span id="cb16-3"><a href="biological_function.html#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pdac_aint_red, <span class="at">file =</span> <span class="st">&quot;backup/07_201_pdac_aint_matrix_GO.rds&quot;</span>)</span>
<span id="cb16-4"><a href="biological_function.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_4000_red, <span class="at">file =</span> <span class="st">&quot;backup/10_201_pbmc_4000_matrix_GO.rds&quot;</span>)</span>
<span id="cb16-5"><a href="biological_function.html#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_6000_red, <span class="at">file =</span> <span class="st">&quot;backup/11_201_pbmc_6000_matrix_GO.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="dimensionality-reduction-1" class="section level2" number="10.7">
<h2><span class="header-section-number">10.7</span> Dimensionality reduction</h2>
<p>Load the objects.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="biological_function.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb17-2"><a href="biological_function.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/plot.R&quot;</span>)</span>
<span id="cb17-3"><a href="biological_function.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/function_asurat.R&quot;</span>)</span>
<span id="cb17-4"><a href="biological_function.html#cb17-4" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/01_201_sc68_vehi_matrix_GO.rds&quot;</span>)</span>
<span id="cb17-5"><a href="biological_function.html#cb17-5" aria-hidden="true" tabindex="-1"></a>sc68_cisp <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/02_201_sc68_cisp_matrix_GO.rds&quot;</span>)</span>
<span id="cb17-6"><a href="biological_function.html#cb17-6" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_201_pdac_aint_matrix_GO.rds&quot;</span>)</span>
<span id="cb17-7"><a href="biological_function.html#cb17-7" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/10_201_pbmc_4000_matrix_GO.rds&quot;</span>)</span>
<span id="cb17-8"><a href="biological_function.html#cb17-8" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/11_201_pbmc_6000_matrix_GO.rds&quot;</span>)</span></code></pre></div>
<div id="principal-component-analysis-optional-1" class="section level3" number="10.7.1">
<h3><span class="header-section-number">10.7.1</span> Principal component analysis (optional)</h3>
<p>The following function <code>do_pca_sign()</code> performs principal component analysis
based on the sign-by-sample matrices of the input <code>data_type</code> and <code>category</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="biological_function.html#cb18-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">do_pca_sign</span>(<span class="at">obj =</span> sc68_vehi, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>)</span>
<span id="cb18-2"><a href="biological_function.html#cb18-2" aria-hidden="true" tabindex="-1"></a>sc68_cisp <span class="ot">&lt;-</span> <span class="fu">do_pca_sign</span>(<span class="at">obj =</span> sc68_cisp, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>)</span>
<span id="cb18-3"><a href="biological_function.html#cb18-3" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">do_pca_sign</span>(<span class="at">obj =</span> pdac_aint, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>)</span>
<span id="cb18-4"><a href="biological_function.html#cb18-4" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">do_pca_sign</span>(<span class="at">obj =</span> pbmc_4000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>)</span>
<span id="cb18-5"><a href="biological_function.html#cb18-5" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">do_pca_sign</span>(<span class="at">obj =</span> pbmc_6000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>)</span></code></pre></div>
<p>The result is stored in <code>obj[["reduction"]][["pca"]][[data_type]][[category]]</code>.</p>
</div>
<div id="t-distributed-stochastic-neighbor-embedding-optional-1" class="section level3" number="10.7.2">
<h3><span class="header-section-number">10.7.2</span> t-distributed stochastic neighbor embedding (optional)</h3>
<p>The following function <code>do_tsne_sign()</code> performs <code>Rtsne()</code> in <code>Rtsne</code> package
based on the sign-by-sample matrices of the input <code>data_type</code> and <code>category</code>.
The arguments are <code>obj</code> (ASURAT object), <code>data_type</code>, <code>category</code>,
<code>pca_dim</code> (number of principal component used for t-SNE, in which <code>NULL</code> is
accepted if users would like to compute t-SNE from the original sample-by-sign
matrices), and <code>tsne_dim</code> (t-SNE dimension: either <code>2</code> or <code>3</code>).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="biological_function.html#cb19-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">do_tsne_sign</span>(<span class="at">obj =</span> sc68_vehi, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb19-2"><a href="biological_function.html#cb19-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">pca_dim =</span> <span class="cn">NULL</span>, <span class="at">tsne_dim =</span> <span class="dv">2</span>)</span>
<span id="cb19-3"><a href="biological_function.html#cb19-3" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">do_tsne_sign</span>(<span class="at">obj =</span> pdac_aint, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb19-4"><a href="biological_function.html#cb19-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">pca_dim =</span> <span class="cn">NULL</span>, <span class="at">tsne_dim =</span> <span class="dv">2</span>)</span>
<span id="cb19-5"><a href="biological_function.html#cb19-5" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">do_tsne_sign</span>(<span class="at">obj =</span> pbmc_4000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb19-6"><a href="biological_function.html#cb19-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">pca_dim =</span> <span class="cn">NULL</span>, <span class="at">tsne_dim =</span> <span class="dv">2</span>)</span>
<span id="cb19-7"><a href="biological_function.html#cb19-7" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">do_tsne_sign</span>(<span class="at">obj =</span> pbmc_6000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb19-8"><a href="biological_function.html#cb19-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">pca_dim =</span> <span class="cn">NULL</span>, <span class="at">tsne_dim =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The result is stored in <code>obj[["reduction"]][["tsne"]][[data_type]][[category]]</code>.</p>
</div>
<div id="uniform-manifold-approximation-and-projection-optional-1" class="section level3" number="10.7.3">
<h3><span class="header-section-number">10.7.3</span> Uniform manifold approximation and projection (optional)</h3>
<p>The following function <code>do_umap_sign()</code> performs <code>umap()</code> in <code>umap</code> package
based on the sign-by-sample matrices of the input <code>data_type</code> and <code>category</code>.
The arguments are <code>obj</code>, <code>data_type</code>, <code>category</code>,
<code>pca_dim</code> (number of principal component used for UMAP, in which <code>NULL</code> is
accepted if users would like to compute UMAP from the original sample-by-sign
matrices), and <code>umap_dim</code> (UMAP dimension: either <code>2</code> or <code>3</code>).</p>
<p><strong>Tips:</strong>
If the resulting diffusion map is distorted by outliers, tuning of <code>pca_dim</code>
will be required.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="biological_function.html#cb20-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">do_umap_sign</span>(<span class="at">obj =</span> sc68_vehi, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb20-2"><a href="biological_function.html#cb20-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">pca_dim =</span> <span class="dv">20</span>, <span class="at">umap_dim =</span> <span class="dv">2</span>)</span>
<span id="cb20-3"><a href="biological_function.html#cb20-3" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">do_umap_sign</span>(<span class="at">obj =</span> pdac_aint, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb20-4"><a href="biological_function.html#cb20-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">pca_dim =</span> <span class="dv">20</span>, <span class="at">umap_dim =</span> <span class="dv">2</span>)</span>
<span id="cb20-5"><a href="biological_function.html#cb20-5" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">do_umap_sign</span>(<span class="at">obj =</span> pbmc_4000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb20-6"><a href="biological_function.html#cb20-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">pca_dim =</span> <span class="cn">NULL</span>, <span class="at">umap_dim =</span> <span class="dv">2</span>)</span>
<span id="cb20-7"><a href="biological_function.html#cb20-7" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">do_umap_sign</span>(<span class="at">obj =</span> pbmc_6000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb20-8"><a href="biological_function.html#cb20-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">pca_dim =</span> <span class="cn">NULL</span>, <span class="at">umap_dim =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The result is stored in <code>obj[["reduction"]][["umap"]][[data_type]][[category]]</code>.</p>
</div>
<div id="diffusion-map-optional-1" class="section level3" number="10.7.4">
<h3><span class="header-section-number">10.7.4</span> Diffusion map (optional)</h3>
<p>Diffusion map is not used in this section.
Please see <a href="cell_type.html#cell_type">previous section</a> for the method.</p>
</div>
<div id="visualization-1" class="section level3" number="10.7.5">
<h3><span class="header-section-number">10.7.5</span> Visualization</h3>
<p>The following functions <code>plot_tsne_sign()</code>, <code>plot_umap_sign()</code>, and
<code>plot_dmap_sign()</code> show sign-by-sample matrices in low dimensional space.
The space dimension is automatically given by <code>tsne_dim</code> used in
<code>do_tsne_sign()</code> for <code>plot_tsne_sign()</code> or <code>umap_dim</code> used in <code>do_umap_sign()</code>
for <code>plot_umap_sign()</code>, while manually given by <code>dims</code> for <code>plot_dmap_sign()</code>.
The arguments are <code>obj</code>, <code>data_type</code>, <code>category</code>, <code>algo_name = NULL</code>, <code>dims</code>
(dimension vector for the plot), <code>theta</code> (angle of view), and
<code>phi</code> (angle of view).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="biological_function.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb21-2"><a href="biological_function.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sc68_vehi</span></span>
<span id="cb21-3"><a href="biological_function.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb21-4"><a href="biological_function.html#cb21-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_umap_sign</span>(<span class="at">obj =</span> sc68_vehi, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb21-5"><a href="biological_function.html#cb21-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">algo_name =</span> <span class="cn">NULL</span>, <span class="at">theta =</span> <span class="cn">NULL</span>, <span class="at">phi =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-6"><a href="biological_function.html#cb21-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">&quot;sc68_vehi (GO: BP)&quot;</span>, <span class="at">title_size =</span> <span class="dv">18</span>,</span>
<span id="cb21-7"><a href="biological_function.html#cb21-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlabel =</span> <span class="st">&quot;UMAP_1&quot;</span>, <span class="at">ylabel =</span> <span class="st">&quot;UMAP_2&quot;</span>, <span class="at">zlabel =</span> <span class="cn">NULL</span>,</span>
<span id="cb21-8"><a href="biological_function.html#cb21-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">default_color =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-9"><a href="biological_function.html#cb21-9" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_01_0205.png&quot;</span></span>
<span id="cb21-10"><a href="biological_function.html#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span> p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="fl">4.3</span>, <span class="at">height =</span> <span class="fl">4.5</span>)</span></code></pre></div>
<p><img src="figures/figure_01_0205.png" width="180px">
<img src="figures/figure_07_0205.png" width="180px"></p>
<p><img src="figures/figure_10_0205.png" width="180px">
<img src="figures/figure_11_0205.png" width="180px"></p>
</div>
<div id="save-results.-1" class="section level3" number="10.7.6">
<h3><span class="header-section-number">10.7.6</span> Save results.</h3>
<p>Save the objects.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="biological_function.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sc68_vehi, <span class="at">file =</span> <span class="st">&quot;backup/01_202_sc68_vehi_reduction_GO.rds&quot;</span>)</span>
<span id="cb22-2"><a href="biological_function.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sc68_cisp, <span class="at">file =</span> <span class="st">&quot;backup/02_202_sc68_cisp_reduction_GO.rds&quot;</span>)</span>
<span id="cb22-3"><a href="biological_function.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pdac_aint, <span class="at">file =</span> <span class="st">&quot;backup/07_202_pdac_aint_reduction_GO.rds&quot;</span>)</span>
<span id="cb22-4"><a href="biological_function.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_4000, <span class="at">file =</span> <span class="st">&quot;backup/10_202_pbmc_4000_reduction_GO.rds&quot;</span>)</span>
<span id="cb22-5"><a href="biological_function.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_6000, <span class="at">file =</span> <span class="st">&quot;backup/11_202_pbmc_6000_reduction_GO.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="cell-clustering-1" class="section level2" number="10.8">
<h2><span class="header-section-number">10.8</span> Cell clustering</h2>
<p>Load the data.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="biological_function.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/plot.R&quot;</span>)</span>
<span id="cb23-2"><a href="biological_function.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/function_asurat.R&quot;</span>)</span>
<span id="cb23-3"><a href="biological_function.html#cb23-3" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/01_202_sc68_vehi_reduction_GO.rds&quot;</span>)</span>
<span id="cb23-4"><a href="biological_function.html#cb23-4" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_202_pdac_aint_reduction_GO.rds&quot;</span>)</span>
<span id="cb23-5"><a href="biological_function.html#cb23-5" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/10_202_pbmc_4000_reduction_GO.rds&quot;</span>)</span>
<span id="cb23-6"><a href="biological_function.html#cb23-6" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/11_202_pbmc_6000_reduction_GO.rds&quot;</span>)</span></code></pre></div>
<p>Here users can choose one of the following unsupervised clustering methods.</p>
<div id="partitioning-around-medoids-pam-optional-1" class="section level3" number="10.8.1">
<h3><span class="header-section-number">10.8.1</span> Partitioning around medoids (PAM) (optional)</h3>
<p>The following function <code>cluster_samples_pam_sign()</code> performs <code>pam()</code> in
<code>cluster</code> package.
The arguments are <code>obj</code>, <code>data_type</code>, <code>category</code>, and <code>k</code> (argument of <code>pam()</code>).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="biological_function.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pdac_aint &lt;- cluster_samples_pam_sign(</span></span>
<span id="cb24-2"><a href="biological_function.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   obj = pdac_aint, data_type = &quot;GO&quot;,category = &quot;BP&quot;, k = 4)</span></span>
<span id="cb24-3"><a href="biological_function.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="biological_function.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-5"><a href="biological_function.html#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Below is a memo for plotting the result.</span></span>
<span id="cb24-6"><a href="biological_function.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-7"><a href="biological_function.html#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># mat &lt;- pdac_aint[[&quot;reduction&quot;]][[&quot;tsne&quot;]][[&quot;GO&quot;]][[&quot;BP&quot;]]$Y</span></span>
<span id="cb24-8"><a href="biological_function.html#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lab &lt;- pdac_aint[[&quot;sample&quot;]][[&quot;pam_GO_BP&quot;]]</span></span>
<span id="cb24-9"><a href="biological_function.html#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># col &lt;- rainbow(length(unique(lab)))</span></span>
<span id="cb24-10"><a href="biological_function.html#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mat, pch=21, bg=col[lab])</span></span>
<span id="cb24-11"><a href="biological_function.html#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># legend(&quot;bottomright&quot;, legend=unique(sort(lab)), pch=21, pt.bg=col)</span></span></code></pre></div>
<p>The results are stored in
<code>obj[["clustering"]][["pam"]][[data_type]][[category]]</code> and
<code>obj[["sample"]][["pam_data_type_category"]]</code>.</p>
</div>
<div id="hierarchical-clustering-and-cutting-tree-optional-1" class="section level3" number="10.8.2">
<h3><span class="header-section-number">10.8.2</span> Hierarchical clustering and cutting tree (optional)</h3>
<p>The following function <code>cluster_samples_hclustCutree_sign()</code> performs
<code>hclust()</code> and <code>cutree()</code> in <code>stats</code> package.
The arguments are <code>obj</code>, <code>data_type</code>, <code>category</code>, <code>method</code>
(argument of <code>hclust()</code>) and <code>k</code> (argument of <code>cutree()</code>).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="biological_function.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pdac_aint &lt;- cluster_samples_hclustCutree_sign(</span></span>
<span id="cb25-2"><a href="biological_function.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   obj = pdac_aint, data_type = &quot;GO&quot;, category = &quot;BP&quot;,</span></span>
<span id="cb25-3"><a href="biological_function.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   method = &quot;ward.D2&quot;, k = 3)</span></span>
<span id="cb25-4"><a href="biological_function.html#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="biological_function.html#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb25-6"><a href="biological_function.html#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Below is a memo for plotting the result.</span></span>
<span id="cb25-7"><a href="biological_function.html#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb25-8"><a href="biological_function.html#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># mat &lt;- pdac_aint[[&quot;reduction&quot;]][[&quot;tsne&quot;]][[&quot;GO&quot;]][[&quot;BP&quot;]]$Y</span></span>
<span id="cb25-9"><a href="biological_function.html#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># lab &lt;- pdac_aint[[&quot;sample&quot;]][[&quot;hclustCutree_GO_BP&quot;]]</span></span>
<span id="cb25-10"><a href="biological_function.html#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># col &lt;- rainbow(length(unique(lab)))</span></span>
<span id="cb25-11"><a href="biological_function.html#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mat, pch=21, bg=col[lab])</span></span>
<span id="cb25-12"><a href="biological_function.html#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co"># legend(&quot;bottomright&quot;, legend=unique(sort(lab)), pch=21, pt.bg=col)</span></span></code></pre></div>
<p>The results are stored in
<code>obj[["clustering"]][["hclustCutree"]][[data_type]][[category]]</code> and
<code>obj[["sample"]][["hclustCutree_data_type_category"]]</code>.</p>
</div>
<div id="community-detection-algorithm-with-k-nearest-neighbor-knn-graph-optional-1" class="section level3" number="10.8.3">
<h3><span class="header-section-number">10.8.3</span> Community detection algorithm with k-nearest neighbor (KNN) graph (optional)</h3>
<p>The following function <code>cluster_samples_seuratFindClusters_sign()</code> performs
<code>CreateSeuratObject()</code>, <code>ScaleData()</code>, <code>RunPCA()</code>, <code>FindNeighbors()</code>, and
<code>FindClusters()</code> in <code>Seurat</code> package.
The arguments are <code>obj</code>, <code>data_type</code>, <code>category</code>, <code>reduction</code>, <code>dims</code>,
<code>k.param</code>, <code>prune.SNN</code>, <code>resolution</code>, and <code>algorithm</code>, where the latter six
parameters are used in <code>FindNeighbors()</code> and <code>FindClusters()</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="biological_function.html#cb26-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">cluster_samples_seuratFindClusters_sign</span>(</span>
<span id="cb26-2"><a href="biological_function.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">obj =</span> sc68_vehi, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">reduction =</span> <span class="st">&quot;pca&quot;</span>,</span>
<span id="cb26-3"><a href="biological_function.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">k.param =</span> <span class="dv">10</span>, <span class="at">prune.SNN =</span> <span class="fl">1.</span><span class="sc">/</span><span class="dv">15</span>, <span class="at">resolution =</span> <span class="fl">0.05</span>,</span>
<span id="cb26-4"><a href="biological_function.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="dv">1</span>)</span>
<span id="cb26-5"><a href="biological_function.html#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="biological_function.html#cb26-6" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">cluster_samples_seuratFindClusters_sign</span>(</span>
<span id="cb26-7"><a href="biological_function.html#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">obj =</span> pdac_aint, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">reduction =</span> <span class="st">&quot;pca&quot;</span>,</span>
<span id="cb26-8"><a href="biological_function.html#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">k.param =</span> <span class="dv">10</span>, <span class="at">prune.SNN =</span> <span class="fl">1.</span><span class="sc">/</span><span class="dv">15</span>, <span class="at">resolution =</span> <span class="fl">0.20</span>,</span>
<span id="cb26-9"><a href="biological_function.html#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="dv">1</span>)</span>
<span id="cb26-10"><a href="biological_function.html#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="biological_function.html#cb26-11" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">cluster_samples_seuratFindClusters_sign</span>(</span>
<span id="cb26-12"><a href="biological_function.html#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">obj =</span> pbmc_4000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">reduction =</span> <span class="st">&quot;pca&quot;</span>,</span>
<span id="cb26-13"><a href="biological_function.html#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">k.param =</span> <span class="dv">10</span>, <span class="at">prune.SNN =</span> <span class="fl">1.</span><span class="sc">/</span><span class="dv">15</span>, <span class="at">resolution =</span> <span class="fl">0.10</span>,</span>
<span id="cb26-14"><a href="biological_function.html#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="dv">1</span>)</span>
<span id="cb26-15"><a href="biological_function.html#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="biological_function.html#cb26-16" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">cluster_samples_seuratFindClusters_sign</span>(</span>
<span id="cb26-17"><a href="biological_function.html#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">obj =</span> pbmc_6000, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>, <span class="at">reduction =</span> <span class="st">&quot;pca&quot;</span>,</span>
<span id="cb26-18"><a href="biological_function.html#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">k.param =</span> <span class="dv">10</span>, <span class="at">prune.SNN =</span> <span class="fl">1.</span><span class="sc">/</span><span class="dv">15</span>, <span class="at">resolution =</span> <span class="fl">0.08</span>,</span>
<span id="cb26-19"><a href="biological_function.html#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">algorithm =</span> <span class="dv">1</span>)</span>
<span id="cb26-20"><a href="biological_function.html#cb26-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-21"><a href="biological_function.html#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-22"><a href="biological_function.html#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Below is a memo for plotting the result.</span></span>
<span id="cb26-23"><a href="biological_function.html#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb26-24"><a href="biological_function.html#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="co"># mat &lt;- pdac_aint[[&quot;reduction&quot;]][[&quot;umap&quot;]][[&quot;GO&quot;]][[&quot;BP&quot;]][[&quot;layout&quot;]]</span></span>
<span id="cb26-25"><a href="biological_function.html#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="co"># lab &lt;- pdac_aint[[&quot;sample&quot;]][[&quot;seuratFindClusters_GO_BP&quot;]]</span></span>
<span id="cb26-26"><a href="biological_function.html#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co"># col &lt;- rainbow(length(unique(lab)))</span></span>
<span id="cb26-27"><a href="biological_function.html#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(mat, pch=21, bg=col[lab])</span></span>
<span id="cb26-28"><a href="biological_function.html#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="co"># legend(&quot;bottomright&quot;, legend=unique(sort(lab)), pch=21, pt.bg=col)</span></span></code></pre></div>
<p>The results are stored in
<code>obj[["sample"]][["seuratFindClusters_data_type_category"]]</code> and
<code>obj[["clustering"]][["seuratFindClusters"]][[data_type]][[category]]</code>.</p>
</div>
<div id="clustering-by-branch-detection-along-pseudotime-optional-1" class="section level3" number="10.8.4">
<h3><span class="header-section-number">10.8.4</span> Clustering by branch detection along pseudotime (optional)</h3>
<p>Branch-based clustering is not used in this section.
Please see <a href="cell_type.html#cell_type">previous section</a> for the method.</p>
</div>
<div id="save-data-1" class="section level3" number="10.8.5">
<h3><span class="header-section-number">10.8.5</span> Save data</h3>
<p>Save the objects.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="biological_function.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sc68_vehi, <span class="at">file =</span> <span class="st">&quot;backup/01_203_sc68_vehi_clustering_GO.rds&quot;</span>)</span>
<span id="cb27-2"><a href="biological_function.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pdac_aint, <span class="at">file =</span> <span class="st">&quot;backup/07_203_pdac_aint_clustering_GO.rds&quot;</span>)</span>
<span id="cb27-3"><a href="biological_function.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_4000, <span class="at">file =</span> <span class="st">&quot;backup/10_203_pbmc_4000_clustering_GO.rds&quot;</span>)</span>
<span id="cb27-4"><a href="biological_function.html#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_6000, <span class="at">file =</span> <span class="st">&quot;backup/11_203_pbmc_6000_clustering_GO.rds&quot;</span>)</span></code></pre></div>
<p>Load the data.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="biological_function.html#cb28-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/01_203_sc68_vehi_clustering_GO.rds&quot;</span>)</span>
<span id="cb28-2"><a href="biological_function.html#cb28-2" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_203_pdac_aint_clustering_GO.rds&quot;</span>)</span>
<span id="cb28-3"><a href="biological_function.html#cb28-3" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/10_203_pbmc_4000_clustering_GO.rds&quot;</span>)</span>
<span id="cb28-4"><a href="biological_function.html#cb28-4" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/11_203_pbmc_6000_clustering_GO.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="visualize-clustering-results-1" class="section level2" number="10.9">
<h2><span class="header-section-number">10.9</span> Visualize clustering results</h2>
<p>In this subsection, the clustering results are visualized.</p>
<p>The following function <code>plot_Heatmap_SignxSamp()</code> visualizes the result of
sample clustering by identifying <code>algo_name</code> (in the current version,
one of <code>"pam"</code>, <code>"hclustCutree"</code>, <code>"seuratFindClusters"</code>, and <code>"merlot"</code>).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="biological_function.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb29-2"><a href="biological_function.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sc68_vehi</span></span>
<span id="cb29-3"><a href="biological_function.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb29-4"><a href="biological_function.html#cb29-4" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_01_0230.png&quot;</span></span>
<span id="cb29-5"><a href="biological_function.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> filename, <span class="at">height =</span> <span class="dv">1000</span>, <span class="at">width =</span> <span class="dv">1400</span>, <span class="at">res =</span> <span class="dv">300</span>)</span>
<span id="cb29-6"><a href="biological_function.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_Heatmap_SignxSamp</span>(<span class="at">obj =</span> sc68_vehi, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb29-7"><a href="biological_function.html#cb29-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">algo_name =</span> <span class="st">&quot;seuratFindClusters&quot;</span>, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>,</span>
<span id="cb29-8"><a href="biological_function.html#cb29-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_nReads =</span> <span class="cn">FALSE</span>, <span class="at">title =</span> <span class="st">&quot;sc68_vehi (GO: BP)&quot;</span>,</span>
<span id="cb29-9"><a href="biological_function.html#cb29-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">name =</span> <span class="st">&quot;Sign score&quot;</span>,</span>
<span id="cb29-10"><a href="biological_function.html#cb29-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_rownames_sign =</span> <span class="cn">FALSE</span>, <span class="at">show_rownames_label =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-11"><a href="biological_function.html#cb29-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">show_rownames_nReads =</span> <span class="cn">FALSE</span>, <span class="at">default_color =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-12"><a href="biological_function.html#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figures/figure_01_0230.png" width="300px">
<img src="figures/figure_07_0230.png" width="300px">
<img src="figures/figure_10_0230.png" width="300px">
<img src="figures/figure_11_0230.png" width="300px"></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="biological_function.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb30-2"><a href="biological_function.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sc68_vehi</span></span>
<span id="cb30-3"><a href="biological_function.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb30-4"><a href="biological_function.html#cb30-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_umap_sign</span>(<span class="at">obj =</span> sc68_vehi, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb30-5"><a href="biological_function.html#cb30-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">algo_name =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb30-6"><a href="biological_function.html#cb30-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">theta =</span> <span class="cn">NULL</span>, <span class="at">phi =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-7"><a href="biological_function.html#cb30-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span> <span class="st">&quot;sc68_vehi (GO: BP)&quot;</span>, <span class="at">title_size =</span> <span class="dv">16</span>,</span>
<span id="cb30-8"><a href="biological_function.html#cb30-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xlabel =</span> <span class="st">&quot;UMAP_1&quot;</span>, <span class="at">ylabel =</span> <span class="st">&quot;UMAP_2&quot;</span>, <span class="at">zlabel =</span> <span class="cn">NULL</span>,</span>
<span id="cb30-9"><a href="biological_function.html#cb30-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">default_color =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-10"><a href="biological_function.html#cb30-10" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_01_0231.png&quot;</span></span>
<span id="cb30-11"><a href="biological_function.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span>  p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="fl">4.9</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="figures/figure_01_0231.png" width="180px">
<img src="figures/figure_07_0231.png" width="180px"></p>
<p><img src="figures/figure_10_0231.png" width="180px">
<img src="figures/figure_11_0231.png" width="180px"></p>
<p>The following command shows the number of cells per cluster visualized
using bar graph.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="biological_function.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb31-2"><a href="biological_function.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sc68_vehi</span></span>
<span id="cb31-3"><a href="biological_function.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb31-4"><a href="biological_function.html#cb31-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_bargraph_sign</span>(<span class="at">obj =</span> sc68_vehi, <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb31-5"><a href="biological_function.html#cb31-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">algo_name =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb31-6"><a href="biological_function.html#cb31-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title =</span> <span class="st">&quot;sc68_vehi&quot;</span>, <span class="at">title_size =</span> <span class="dv">20</span>,</span>
<span id="cb31-7"><a href="biological_function.html#cb31-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xlabel =</span> <span class="st">&quot;Label (GO: BP)&quot;</span>,</span>
<span id="cb31-8"><a href="biological_function.html#cb31-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ylabel =</span> <span class="st">&quot;Number of samples&quot;</span>, <span class="at">ymax =</span> <span class="dv">3500</span>)</span>
<span id="cb31-9"><a href="biological_function.html#cb31-9" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_01_0235.png&quot;</span></span>
<span id="cb31-10"><a href="biological_function.html#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span> p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="fl">4.3</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="figures/figure_01_0235.png" width="180px">
<img src="figures/figure_07_0235.png" width="180px"></p>
<p><img src="figures/figure_10_0235.png" width="180px">
<img src="figures/figure_11_0235.png" width="180px"></p>
</div>
<div id="find-significant-signs-1" class="section level2" number="10.10">
<h2><span class="header-section-number">10.10</span> Find significant signs</h2>
<div id="compute-separation-indices-1" class="section level3" number="10.10.1">
<h3><span class="header-section-number">10.10.1</span> Compute separation indices</h3>
<p>In this subsection, signs with sign scores being specifically upregulated in
some cluster are detected by computing the separation indices (sep_I), i.e.,
non-parametric measure of degree in separation of two random variable sets
(see our paper for the definition).
The concept of significant sign is similar to that of differentially expressed
genes (DEGs).</p>
<p>Load the data.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="biological_function.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/plot.R&quot;</span>)</span>
<span id="cb32-2"><a href="biological_function.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/function_asurat.R&quot;</span>)</span>
<span id="cb32-3"><a href="biological_function.html#cb32-3" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/01_203_sc68_vehi_clustering_GO.rds&quot;</span>)</span>
<span id="cb32-4"><a href="biological_function.html#cb32-4" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_203_pdac_aint_clustering_GO.rds&quot;</span>)</span>
<span id="cb32-5"><a href="biological_function.html#cb32-5" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/10_203_pbmc_4000_clustering_GO.rds&quot;</span>)</span>
<span id="cb32-6"><a href="biological_function.html#cb32-6" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/11_203_pbmc_6000_clustering_GO.rds&quot;</span>)</span></code></pre></div>
<p>The following function <code>auto_find_marker_sign()</code> computes separation indices
of signs of interest for each subpopulation.
The arguments are <code>obj</code>,
<code>data_type_for_label</code> (<code>data_type</code> used for sample clustering),
<code>category_for_label</code> (<code>category</code> used for sample clustering),
<code>algo_name_for_label</code> (<code>algo_name</code> used for sample clustering),
<code>data_type_for_expr</code> (<code>data_type</code> that the signs of interest belong to),
<code>category_for_expr</code> (<code>category</code> that the signs of interest belong to).
This function helps users find positive and negative marker signs of <code>label_1</code>
with the positive and negative values of the indices, respectively.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="biological_function.html#cb33-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">auto_find_marker_sign</span>(<span class="at">obj =</span> sc68_vehi, <span class="at">data_type_for_label =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb33-2"><a href="biological_function.html#cb33-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">category_for_label =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb33-3"><a href="biological_function.html#cb33-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">algo_name_for_label =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb33-4"><a href="biological_function.html#cb33-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">data_type_for_expr =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb33-5"><a href="biological_function.html#cb33-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">category_for_expr =</span> <span class="st">&quot;BP&quot;</span>)</span>
<span id="cb33-6"><a href="biological_function.html#cb33-6" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">auto_find_marker_sign</span>(<span class="at">obj =</span> pdac_aint, <span class="at">data_type_for_label =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb33-7"><a href="biological_function.html#cb33-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">category_for_label =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb33-8"><a href="biological_function.html#cb33-8" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">algo_name_for_label =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb33-9"><a href="biological_function.html#cb33-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">data_type_for_expr =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb33-10"><a href="biological_function.html#cb33-10" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">category_for_expr =</span> <span class="st">&quot;BP&quot;</span>)</span>
<span id="cb33-11"><a href="biological_function.html#cb33-11" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">auto_find_marker_sign</span>(<span class="at">obj =</span> pbmc_4000, <span class="at">data_type_for_label =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb33-12"><a href="biological_function.html#cb33-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">category_for_label =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb33-13"><a href="biological_function.html#cb33-13" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">algo_name_for_label =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb33-14"><a href="biological_function.html#cb33-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">data_type_for_expr =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb33-15"><a href="biological_function.html#cb33-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">category_for_expr =</span> <span class="st">&quot;BP&quot;</span>)</span>
<span id="cb33-16"><a href="biological_function.html#cb33-16" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">auto_find_marker_sign</span>(<span class="at">obj =</span> pbmc_6000, <span class="at">data_type_for_label =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb33-17"><a href="biological_function.html#cb33-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">category_for_label =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb33-18"><a href="biological_function.html#cb33-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">algo_name_for_label =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb33-19"><a href="biological_function.html#cb33-19" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">data_type_for_expr =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb33-20"><a href="biological_function.html#cb33-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">category_for_expr =</span> <span class="st">&quot;BP&quot;</span>)</span></code></pre></div>
<p>The results are stored in
<code>obj[["marker"]][[data_type_for_expr]][[category_for_expr]]</code>.
Here <code>sep_I</code> stands for separation indices of signs, which quantifies the
extent of separation between two different sets of random variables.</p>
<p>Note that <code>auto_find_marker_sign()</code> computes <code>sep_I</code> for a given group versus
all other cells.
On the other hand, to compute <code>sep_I</code> for given two groups, e.g.,
groups 1 versus 2, run function <code>find_marker_sign()</code> as follows:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="biological_function.html#cb34-1" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">find_marker_sign</span>(<span class="at">obj =</span> pdac_aint, <span class="at">data_type_for_label =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb34-2"><a href="biological_function.html#cb34-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">category_for_label =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb34-3"><a href="biological_function.html#cb34-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">algo_name_for_label =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb34-4"><a href="biological_function.html#cb34-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data_type_for_expr =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb34-5"><a href="biological_function.html#cb34-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">category_for_expr =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb34-6"><a href="biological_function.html#cb34-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labels_1 =</span> <span class="dv">1</span>, <span class="at">labels_2 =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The results are stored in
<code>obj[["marker"]][[data_type_for_expr]][[category_for_expr]]</code> such as
<code>obj[["marker"]][["GO"]][["BP"]][["Label_GO_BP_1_vs_2"]]</code>.</p>
<p>To detect differentially expressed genes, users can use our similar functions
<code>find_marker_gene()</code> and <code>auto_find_marker_gene()</code>, which perform multiple
statistical tests for comparing two groups using normalized read counts, i.e.,
<code>obj[["data"]][["normalized"]]</code>.
The arguments of <code>find_marker_gene()</code> are <code>obj</code>, <code>data_type_for_label</code>,
<code>category_for_label</code>, <code>algo_name_for_label</code>, <code>labels_1</code>, <code>labels_2</code>, and
<code>parametric</code> (<code>TRUE</code> or <code>FALSE</code> for <code>t.test()</code> or <code>wilcox.exact()</code>, resp.).
The arguments of <code>auto_find_marker_gene()</code> are <code>obj</code>, <code>data_type_for_label</code>,
<code>category_for_label</code>, <code>algo_name_for_label</code>, and <code>parametric</code>
(<code>TRUE</code> or <code>FALSE</code> for <code>t.test()</code> or <code>wilcox.exact()</code>, resp.).
For example,</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="biological_function.html#cb35-1" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">auto_find_marker_gene</span>(<span class="at">obj =</span> pdac_aint, <span class="at">data_type_for_label =</span> <span class="st">&quot;GO&quot;</span>,</span>
<span id="cb35-2"><a href="biological_function.html#cb35-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">category_for_label =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb35-3"><a href="biological_function.html#cb35-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">algo_name_for_label =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb35-4"><a href="biological_function.html#cb35-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">parametric =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The results are stored in
<code>obj[["marker"]][["gene"]][[data_type_for_expr]][[category_for_expr]]</code>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="biological_function.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(sc68_vehi[[<span class="st">&quot;marker&quot;</span>]][[<span class="st">&quot;GO&quot;</span>]][[<span class="st">&quot;BP&quot;</span>]][[<span class="st">&quot;all&quot;</span>]], <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-2"><a href="biological_function.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(pdac_aint[[<span class="st">&quot;marker&quot;</span>]][[<span class="st">&quot;GO&quot;</span>]][[<span class="st">&quot;BP&quot;</span>]][[<span class="st">&quot;all&quot;</span>]], <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-3"><a href="biological_function.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(pbmc_4000[[<span class="st">&quot;marker&quot;</span>]][[<span class="st">&quot;GO&quot;</span>]][[<span class="st">&quot;BP&quot;</span>]][[<span class="st">&quot;all&quot;</span>]], <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span>
<span id="cb36-4"><a href="biological_function.html#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(pbmc_6000[[<span class="st">&quot;marker&quot;</span>]][[<span class="st">&quot;GO&quot;</span>]][[<span class="st">&quot;BP&quot;</span>]][[<span class="st">&quot;all&quot;</span>]], <span class="at">rownames =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<ul>
<li><code>sc68_vehi</code></li>
</ul>
<iframe src="figures/sc68_vehi_GO_BP.html" style="width:100%; height:400px;">
</iframe>
<p><br><br><br><br><br><br><br><br><br><br></p>
<ul>
<li><code>pdac_aint</code></li>
</ul>
<iframe src="figures/pdac_aint_GO_BP.html" style="width:100%; height:400px;">
</iframe>
<p><br><br><br><br><br><br><br><br><br><br></p>
<ul>
<li><code>pbmc_4000</code></li>
</ul>
<iframe src="figures/pbmc_4000_GO_BP.html" style="width:100%; height:400px;">
</iframe>
<p><br><br><br><br><br><br><br><br><br><br></p>
<ul>
<li><code>pbmc_6000</code></li>
</ul>
<iframe src="figures/pbmc_6000_GO_BP.html" style="width:100%; height:400px;">
</iframe>
<p><br><br><br><br><br><br><br><br><br><br></p>
<p>Save the objects.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="biological_function.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(sc68_vehi, <span class="at">file =</span> <span class="st">&quot;backup/01_204_sc68_vehi_DES_GO.rds&quot;</span>)</span>
<span id="cb37-2"><a href="biological_function.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pdac_aint, <span class="at">file =</span> <span class="st">&quot;backup/07_204_pdac_aint_DES_GO.rds&quot;</span>)</span>
<span id="cb37-3"><a href="biological_function.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_4000, <span class="at">file =</span> <span class="st">&quot;backup/10_204_pbmc_4000_DES_GO.rds&quot;</span>)</span>
<span id="cb37-4"><a href="biological_function.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc_6000, <span class="at">file =</span> <span class="st">&quot;backup/11_204_pbmc_6000_DES_GO.rds&quot;</span>)</span></code></pre></div>
<p>Load the data.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="biological_function.html#cb38-1" aria-hidden="true" tabindex="-1"></a>sc68_vehi <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/01_204_sc68_vehi_DES_GO.rds&quot;</span>)</span>
<span id="cb38-2"><a href="biological_function.html#cb38-2" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_204_pdac_aint_DES_GO.rds&quot;</span>)</span>
<span id="cb38-3"><a href="biological_function.html#cb38-3" aria-hidden="true" tabindex="-1"></a>pbmc_4000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/10_204_pbmc_4000_DES_GO.rds&quot;</span>)</span>
<span id="cb38-4"><a href="biological_function.html#cb38-4" aria-hidden="true" tabindex="-1"></a>pbmc_6000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/11_204_pbmc_6000_DES_GO.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="investigate-sign-scores-1" class="section level3" number="10.10.2">
<h3><span class="header-section-number">10.10.2</span> Investigate sign scores</h3>
<p>The following function <code>plot_violin_signScore()</code> shows distribution of
sign scores across all the clusters by violin plots.
The arguments are <code>obj</code>, <code>sign_name</code> (sign ID),
<code>data_type_for_label</code> (<code>data_type</code> used for sample clustering),
<code>category_for_label</code> (<code>category</code> used for sample clustering),
<code>algo_name_for_label</code> (<code>algo_name</code> used for sample clustering),
<code>data_type_for_expr</code> (<code>data_type</code> that the signs of interest belong to),
<code>category_for_expr</code> (<code>category</code> that the signs of interest belong to).</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="biological_function.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb39-2"><a href="biological_function.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sc68_vehi</span></span>
<span id="cb39-3"><a href="biological_function.html#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb39-4"><a href="biological_function.html#cb39-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_violin_signScore</span>(</span>
<span id="cb39-5"><a href="biological_function.html#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">obj =</span> sc68_vehi, <span class="at">sign_name =</span> <span class="st">&quot;GO:0033044_S&quot;</span>,</span>
<span id="cb39-6"><a href="biological_function.html#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_type_for_label =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category_for_label =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb39-7"><a href="biological_function.html#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">algo_name_for_label =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb39-8"><a href="biological_function.html#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_type_for_expr =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category_for_expr =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb39-9"><a href="biological_function.html#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;GO:0033044_S</span><span class="sc">\n</span><span class="st">Reg..chromosome organization</span><span class="sc">\n</span><span class="st">(CDC20/CENPF/..)&quot;</span>,</span>
<span id="cb39-10"><a href="biological_function.html#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title_size =</span> <span class="dv">16</span>, <span class="at">default_color =</span> <span class="cn">FALSE</span>)</span>
<span id="cb39-11"><a href="biological_function.html#cb39-11" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_01_0240.png&quot;</span></span>
<span id="cb39-12"><a href="biological_function.html#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span> p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<ul>
<li><code>sc68_vehi</code></li>
</ul>
<p><img src="figures/figure_01_0240.png" width="230px"></p>
<ul>
<li><code>pdac_aint</code></li>
</ul>
<p><img src="figures/figure_07_0240.png" width="230px">
<img src="figures/figure_07_0241.png" width="230px"></p>
<ul>
<li><code>pbmc_4000</code></li>
</ul>
<p><img src="figures/figure_10_0240.png" width="230px">
<img src="figures/figure_10_0241.png" width="230px">
<img src="figures/figure_10_0242.png" width="230px">
<img src="figures/figure_10_0243.png" width="230px">
<img src="figures/figure_10_0244.png" width="230px"></p>
<ul>
<li><code>pbmc_6000</code></li>
</ul>
<p><img src="figures/figure_11_0240.png" width="230px">
<img src="figures/figure_11_0241.png" width="230px">
<img src="figures/figure_11_0242.png" width="230px"></p>
<p>The functions <code>plot_tsne_signScore()</code>, <code>plot_umap_signScore()</code>, and
<code>plot_dmap_signScore()</code> show sign scores of a given sign on t-SNE, UMAP, and
diffusion map spaces, respectively.
The arguments are <code>obj</code>, <code>sign_name</code> (sign ID),
<code>data_type_for_label</code> (<code>data_type</code> used for sample clustering),
<code>category_for_label</code> (<code>category</code> used for sample clustering),
<code>data_type_for_expr</code> (<code>data_type</code> that the signs of interest belong to),
<code>category_for_expr</code> (<code>category</code> that the signs of interest belong to).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="biological_function.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb40-2"><a href="biological_function.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pdac_aint</span></span>
<span id="cb40-3"><a href="biological_function.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb40-4"><a href="biological_function.html#cb40-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_umap_signScore</span>(</span>
<span id="cb40-5"><a href="biological_function.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">obj =</span> pdac_aint, <span class="at">sign_name =</span> <span class="st">&quot;GO:0090090_V&quot;</span>,</span>
<span id="cb40-6"><a href="biological_function.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_type_for_umap =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category_for_umap =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb40-7"><a href="biological_function.html#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_type_for_expr =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category_for_expr =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb40-8"><a href="biological_function.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> <span class="cn">NULL</span>, <span class="at">phi =</span> <span class="cn">NULL</span>,</span>
<span id="cb40-9"><a href="biological_function.html#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;GO:0090090_V</span><span class="sc">\n</span><span class="st">Negative reg..Wnt signal..</span><span class="sc">\n</span><span class="st">(AMFR/DVL1/..)&quot;</span>,</span>
<span id="cb40-10"><a href="biological_function.html#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">title_size =</span> <span class="dv">16</span>, <span class="at">label_name =</span> <span class="st">&quot;Sign score&quot;</span>,</span>
<span id="cb40-11"><a href="biological_function.html#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlabel =</span> <span class="st">&quot;UMAP_1&quot;</span>, <span class="at">ylabel =</span> <span class="st">&quot;UMAP_2&quot;</span>, <span class="at">zlabel =</span> <span class="cn">NULL</span>)</span>
<span id="cb40-12"><a href="biological_function.html#cb40-12" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_07_0250.png&quot;</span></span>
<span id="cb40-13"><a href="biological_function.html#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span> p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="fl">5.5</span>, <span class="at">height =</span> <span class="fl">4.4</span>)</span></code></pre></div>
<ul>
<li><code>pdac_aint</code></li>
</ul>
<p><img src="figures/figure_07_0250.png" width="230px">
<img src="figures/figure_07_0251.png" width="230px"></p>
<p>The functions <code>plot_tsne_geneExpression()</code>, <code>plot_umap_geneExpression()</code>, and
<code>plot_dmap_geneExpression()</code> show normalized gene expression levels
(if <code>zscore = TRUE</code>, the expression levels are converted into z-score) for
input genes (<code>gene_names</code>) on low dimensional space.
Note that if <code>gene_names</code> has more than one gene, the expression levels are
shown as the average of them.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="biological_function.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb41-2"><a href="biological_function.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pdac_aint</span></span>
<span id="cb41-3"><a href="biological_function.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb41-4"><a href="biological_function.html#cb41-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_umap_geneExpression</span>(</span>
<span id="cb41-5"><a href="biological_function.html#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">obj =</span> pdac_aint, <span class="at">gene_names =</span> <span class="fu">c</span>(<span class="st">&quot;TM4SF1&quot;</span>), <span class="at">zscore =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-6"><a href="biological_function.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_type_for_umap =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category_for_umap =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb41-7"><a href="biological_function.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">theta =</span> <span class="dv">0</span>, <span class="at">phi =</span> <span class="dv">0</span>,</span>
<span id="cb41-8"><a href="biological_function.html#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;pdac_aint (GO: BP)&quot;</span>, <span class="at">title_size =</span> <span class="dv">16</span>,</span>
<span id="cb41-9"><a href="biological_function.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">label_name =</span> <span class="st">&quot;TM4SF1&quot;</span>,</span>
<span id="cb41-10"><a href="biological_function.html#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlabel =</span> <span class="st">&quot;UMAP_1&quot;</span>, <span class="at">ylabel =</span> <span class="st">&quot;UMAP_2&quot;</span>, <span class="at">zlabel =</span> <span class="cn">NULL</span>)</span>
<span id="cb41-11"><a href="biological_function.html#cb41-11" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_07_0260.png&quot;</span></span>
<span id="cb41-12"><a href="biological_function.html#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span> p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="fl">5.3</span>, <span class="at">height =</span> <span class="dv">4</span>)</span></code></pre></div>
<ul>
<li><code>pdac_aint</code></li>
</ul>
<p><img src="figures/figure_07_0260.png" width="230px">
<img src="figures/figure_07_0261.png" width="230px"></p>
</div>
</div>
<div id="investigate-batch-effects-1" class="section level2" number="10.11">
<h2><span class="header-section-number">10.11</span> Investigate batch effects</h2>
<p>Load the data.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="biological_function.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;R/plot.R&quot;</span>)</span>
<span id="cb42-2"><a href="biological_function.html#cb42-2" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_204_pdac_aint_DES_GO.rds&quot;</span>)</span></code></pre></div>
<p>The following function <code>plot_manifold_sign()</code> outputs a <code>ggplot</code> object,
which shows the clustering results between batches or putative subpopulations
in a two-dimensional reduced space.
The arguments are <code>obj_seurat</code> (Seurat object), <code>batch</code> (<code>TRUE</code> or <code>FALSE</code>:
if <code>TRUE</code>, the batch information is labeled, otherwise inferred clusters are
labeled), <code>plot_type</code> (one of <code>"tsne"</code>, <code>"umap"</code>, or <code>"dmap"</code>),
<code>data_type</code>, <code>category</code>, and <code>algo_name</code>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="biological_function.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb43-2"><a href="biological_function.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pdac_aint</span></span>
<span id="cb43-3"><a href="biological_function.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb43-4"><a href="biological_function.html#cb43-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_manifold_sign</span>(<span class="at">obj =</span> pdac_aint, <span class="at">batch =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-5"><a href="biological_function.html#cb43-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">plot_type =</span> <span class="st">&quot;umap&quot;</span>,</span>
<span id="cb43-6"><a href="biological_function.html#cb43-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb43-7"><a href="biological_function.html#cb43-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">algo_name =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb43-8"><a href="biological_function.html#cb43-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title =</span> <span class="st">&quot;pdac_aint&quot;</span>, <span class="at">title_size =</span> <span class="dv">18</span>,</span>
<span id="cb43-9"><a href="biological_function.html#cb43-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xlabel =</span> <span class="st">&quot;UMAP_1&quot;</span>, <span class="at">ylabel =</span> <span class="st">&quot;UMAP_2&quot;</span>,</span>
<span id="cb43-10"><a href="biological_function.html#cb43-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">default_color =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-11"><a href="biological_function.html#cb43-11" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_07_0280.png&quot;</span></span>
<span id="cb43-12"><a href="biological_function.html#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span> p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="fl">6.3</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb43-13"><a href="biological_function.html#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="biological_function.html#cb43-14" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_manifold_sign</span>(<span class="at">obj =</span> pdac_aint, <span class="at">batch =</span> <span class="cn">FALSE</span>,</span>
<span id="cb43-15"><a href="biological_function.html#cb43-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">plot_type =</span> <span class="st">&quot;umap&quot;</span>,</span>
<span id="cb43-16"><a href="biological_function.html#cb43-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data_type =</span> <span class="st">&quot;GO&quot;</span>, <span class="at">category =</span> <span class="st">&quot;BP&quot;</span>,</span>
<span id="cb43-17"><a href="biological_function.html#cb43-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">algo_name =</span> <span class="st">&quot;seuratFindClusters&quot;</span>,</span>
<span id="cb43-18"><a href="biological_function.html#cb43-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title =</span> <span class="st">&quot;pdac_aint&quot;</span>,</span>
<span id="cb43-19"><a href="biological_function.html#cb43-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title_size =</span> <span class="dv">18</span>, <span class="at">xlabel =</span> <span class="st">&quot;UMAP_1&quot;</span>, <span class="at">ylabel =</span> <span class="st">&quot;UMAP_2&quot;</span>,</span>
<span id="cb43-20"><a href="biological_function.html#cb43-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">default_color =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-21"><a href="biological_function.html#cb43-21" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_07_0281.png&quot;</span></span>
<span id="cb43-22"><a href="biological_function.html#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span> p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="fl">4.2</span>)</span></code></pre></div>
<p><img src="figures/figure_07_0280.png" width="230px">
<img src="figures/figure_07_0281.png" width="230px"></p>
</div>
<div id="spatial-mapping-by-spaniel-1" class="section level2" number="10.12">
<h2><span class="header-section-number">10.12</span> Spatial mapping by Spaniel</h2>
<p>Load the data.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="biological_function.html#cb44-1" aria-hidden="true" tabindex="-1"></a>pdac_aint <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/07_204_pdac_aint_DES_GO.rds&quot;</span>)</span>
<span id="cb44-2"><a href="biological_function.html#cb44-2" aria-hidden="true" tabindex="-1"></a>pdac_ast1 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;backup/05_005_pdac_ast1_normalized.rds&quot;</span>)</span>
<span id="cb44-3"><a href="biological_function.html#cb44-3" aria-hidden="true" tabindex="-1"></a>fn <span class="ot">&lt;-</span> <span class="st">&quot;data/2020_001_Moncada/pdac_ast1/tissue_positions_list_spatial_object.tsv&quot;</span></span></code></pre></div>
<p>Create a Seurat object keeping only ST spots in integrated data <code>pdac_aint</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="biological_function.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb45-2"><a href="biological_function.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pdac_aint</span></span>
<span id="cb45-3"><a href="biological_function.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb45-4"><a href="biological_function.html#cb45-4" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> pdac_aint[[<span class="st">&quot;sample&quot;</span>]]</span>
<span id="cb45-5"><a href="biological_function.html#cb45-5" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> tmp[<span class="fu">which</span>(tmp<span class="sc">$</span>orig_ident <span class="sc">==</span> <span class="st">&quot;ST&quot;</span>),]</span>
<span id="cb45-6"><a href="biological_function.html#cb45-6" aria-hidden="true" tabindex="-1"></a>pdac_aint[[<span class="st">&quot;sample&quot;</span>]] <span class="ot">&lt;-</span> tmp</span>
<span id="cb45-7"><a href="biological_function.html#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="biological_function.html#cb45-8" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> pdac_aint[[<span class="st">&quot;sign&quot;</span>]][[<span class="st">&quot;GOxSample&quot;</span>]][[<span class="st">&quot;BP&quot;</span>]]</span>
<span id="cb45-9"><a href="biological_function.html#cb45-9" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> pdac_aint[[<span class="st">&quot;sample&quot;</span>]][[<span class="st">&quot;barcode&quot;</span>]]</span>
<span id="cb45-10"><a href="biological_function.html#cb45-10" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> mat[, <span class="fu">which</span>(<span class="fu">colnames</span>(mat) <span class="sc">%in%</span> tmp)]</span>
<span id="cb45-11"><a href="biological_function.html#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mat) <span class="ot">&lt;-</span> pdac_ast1[[<span class="st">&quot;sample&quot;</span>]][[<span class="st">&quot;spot&quot;</span>]]  <span class="co"># This is required by Spaniel</span></span>
<span id="cb45-12"><a href="biological_function.html#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb45-13"><a href="biological_function.html#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># se</span></span>
<span id="cb45-14"><a href="biological_function.html#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co"># ----------------------------------------</span></span>
<span id="cb45-15"><a href="biological_function.html#cb45-15" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> Spaniel<span class="sc">::</span><span class="fu">createSeurat</span>(<span class="at">counts =</span> mat, <span class="at">barcodeFile =</span> fn,</span>
<span id="cb45-16"><a href="biological_function.html#cb45-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">projectName =</span> <span class="st">&quot;PDAC-A&quot;</span>, <span class="at">sectionNumber =</span> <span class="st">&quot;1&quot;</span>)</span>
<span id="cb45-17"><a href="biological_function.html#cb45-17" aria-hidden="true" tabindex="-1"></a>se<span class="sc">@</span>images <span class="ot">&lt;-</span> pdac_aint[[<span class="st">&quot;misc&quot;</span>]][[<span class="st">&quot;images&quot;</span>]]</span></code></pre></div>
<p>Pre-processing.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="biological_function.html#cb46-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> pdac_aint[[<span class="st">&quot;sample&quot;</span>]][[<span class="st">&quot;seuratFindClusters_GO_BP&quot;</span>]]</span>
<span id="cb46-2"><a href="biological_function.html#cb46-2" aria-hidden="true" tabindex="-1"></a>se<span class="sc">@</span>meta.data[[<span class="st">&quot;cluster&quot;</span>]] <span class="ot">&lt;-</span> tmp</span>
<span id="cb46-3"><a href="biological_function.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">SetIdent</span>(se, <span class="at">value =</span> <span class="st">&quot;cluster&quot;</span>)</span>
<span id="cb46-4"><a href="biological_function.html#cb46-4" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(se)</span></code></pre></div>
<p>Visualize clusters on tissue images.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="biological_function.html#cb47-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">spanielPlot</span>(<span class="at">object =</span> se, <span class="at">grob =</span> se<span class="sc">@</span>images[[<span class="dv">1</span>]], <span class="at">plotType =</span> <span class="st">&quot;Cluster&quot;</span>,</span>
<span id="cb47-2"><a href="biological_function.html#cb47-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">clusterRes =</span> <span class="st">&quot;cluster&quot;</span>, <span class="at">ptSize =</span> <span class="fl">2.5</span>,</span>
<span id="cb47-3"><a href="biological_function.html#cb47-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">customTitle =</span> <span class="st">&quot;Cluster (GO:BP)&quot;</span>)</span>
<span id="cb47-4"><a href="biological_function.html#cb47-4" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_07_0290.png&quot;</span></span>
<span id="cb47-5"><a href="biological_function.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span> p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="fl">5.1</span>, <span class="at">height =</span> <span class="fl">4.2</span>)</span></code></pre></div>
<p><img src="figures/figure_07_0290.png" width="400px"></p>
<p>Visualize sign scores on histological images.
Note that in <code>se</code> underscores "_" were replaced with hyphens “-”.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="biological_function.html#cb48-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">spanielPlot</span>(<span class="at">object =</span> se, <span class="at">grob =</span> se<span class="sc">@</span>images[[<span class="dv">1</span>]], <span class="at">plotType =</span> <span class="st">&quot;Gene&quot;</span>,</span>
<span id="cb48-2"><a href="biological_function.html#cb48-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">gene =</span> <span class="st">&quot;GO:0090090-V&quot;</span>, <span class="at">ptSizeMax =</span> <span class="fl">2.5</span>,  <span class="at">ptSizeMin =</span> <span class="dv">0</span>,</span>
<span id="cb48-3"><a href="biological_function.html#cb48-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">customTitle =</span> <span class="st">&quot;GO:0090090_V&quot;</span>)</span>
<span id="cb48-4"><a href="biological_function.html#cb48-4" aria-hidden="true" tabindex="-1"></a>filename <span class="ot">&lt;-</span> <span class="st">&quot;figures/figure_07_0295.png&quot;</span></span>
<span id="cb48-5"><a href="biological_function.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">file =</span> filename, <span class="at">plot =</span> p, <span class="at">dpi =</span> <span class="dv">300</span>, <span class="at">width =</span> <span class="fl">4.7</span>, <span class="at">height =</span> <span class="fl">4.1</span>)</span></code></pre></div>
<ul>
<li><a href="GO:0090090_V" class="uri">GO:0090090_V</a> Negative reg..Wnt signal.. (AMFR/DVL1/..)</li>
</ul>
<p><img src="figures/figure_07_0295.png" width="300px"></p>
<ul>
<li><a href="GO:0030857_S" class="uri">GO:0030857_S</a> Negative reg..epithelial cell diff.. (REG3A/GSK3B/..)</li>
</ul>
<p><img src="figures/figure_07_0296.png" width="300px"></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cell_type.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pathway.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Introduction to ASURAT (ver. 0.0.0.9000).pdf", "Introduction to ASURAT (ver. 0.0.0.9000).epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
